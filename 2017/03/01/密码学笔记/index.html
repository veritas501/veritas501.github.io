<!DOCTYPE html>












  


<html class="theme-next gemini use-motion" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2"/>
<meta name="theme-color" content="#222">












<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />






















<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=6.3.0" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.3.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.3.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.3.0">










<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '6.3.0',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":true,"scrollpercent":true,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="此处会长期更新我做过的一些密码学题目。  RSA一些基本知识： RSA中几个用到的字母：P : 大质数pQ : 大质数qN :  n=p*qφ(n) = φ(p) * φ(q) = (p − 1)(q − 1) = n − (p + q − 1)e : encryption key (public key) (又称加密指数)d : decryption key (private key)  e对于">
<meta name="keywords" content="CTF,CRYPTO">
<meta property="og:type" content="article">
<meta property="og:title" content="密码学笔记">
<meta property="og:url" content="https://veritas501.github.io/2017/03/01/密码学笔记/index.html">
<meta property="og:site_name" content="Veritas501&#39;s Blog">
<meta property="og:description" content="此处会长期更新我做过的一些密码学题目。  RSA一些基本知识： RSA中几个用到的字母：P : 大质数pQ : 大质数qN :  n=p*qφ(n) = φ(p) * φ(q) = (p − 1)(q − 1) = n − (p + q − 1)e : encryption key (public key) (又称加密指数)d : decryption key (private key)  e对于">
<meta property="og:locale" content="en">
<meta property="og:image" content="http://ordvwjm69.bkt.clouddn.com/crypto_note_26e429e1b846088e78be9866e092a6cc.png">
<meta property="og:image" content="http://ordvwjm69.bkt.clouddn.com/crypto_note_3c9f2e327f7c112f0b150a042abd3d1a.png">
<meta property="og:image" content="http://ordvwjm69.bkt.clouddn.com/crypto_note_d7e8092b0a64fb46291630b009191b40.png">
<meta property="og:image" content="http://ordvwjm69.bkt.clouddn.com/crypto_note_a5e3b41452ee888931dcc59f4fafa9ba.png">
<meta property="og:image" content="http://ordvwjm69.bkt.clouddn.com/crypto_note_f979ce71270ca29da35f4d5f20a755e6.png">
<meta property="og:image" content="http://ordvwjm69.bkt.clouddn.com/crypto_note_a814f664d8bc605fe2a1a8b2f29e5570.png">
<meta property="og:updated_time" content="2017-08-25T05:37:27.254Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="密码学笔记">
<meta name="twitter:description" content="此处会长期更新我做过的一些密码学题目。  RSA一些基本知识： RSA中几个用到的字母：P : 大质数pQ : 大质数qN :  n=p*qφ(n) = φ(p) * φ(q) = (p − 1)(q − 1) = n − (p + q − 1)e : encryption key (public key) (又称加密指数)d : decryption key (private key)  e对于">
<meta name="twitter:image" content="http://ordvwjm69.bkt.clouddn.com/crypto_note_26e429e1b846088e78be9866e092a6cc.png">






  <link rel="canonical" href="https://veritas501.github.io/2017/03/01/密码学笔记/"/>



<script type="text/javascript" id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>密码学笔记 | Veritas501's Blog</title>
  









  <noscript>
  <style type="text/css">
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion {
      .logo-line-before i { left: initial; }
      .logo-line-after i { right: initial; }
    }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Veritas501's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">
    <a href="/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-home"></i> <br />Home</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-about">
    <a href="/about/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-user"></i> <br />About</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">
    <a href="/archives/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />Archives</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">
    <a href="/tags/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />Tags</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-guestbook">
    <a href="/Guestbook" rel="section">
      <i class="menu-item-icon fa fa-fw fa-pencil"></i> <br />Guestbook</a>
  </li>

      
      
    </ul>
  

  

  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://veritas501.github.io/2017/03/01/密码学笔记/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Veritas501">
      <meta itemprop="description" content="开始踏上Re&Pwn之路...">
      <meta itemprop="image" content="/images/215.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Veritas501's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">密码学笔记
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2017-03-01 00:00:00" itemprop="dateCreated datePublished" datetime="2017-03-01T00:00:00+08:00">2017-03-01</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2017-08-25 13:37:27" itemprop="dateModified" datetime="2017-08-25T13:37:27+08:00">2017-08-25</time>
              
            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/03/01/密码学笔记/#comments" itemprop="discussionUrl">
                  <span class="post-meta-item-text">Comments: </span> <span class="post-comments-count valine-comment-count" data-xid="/2017/03/01/密码学笔记/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
             <span id="/2017/03/01/密码学笔记/" class="leancloud_visitors" data-flag-title="密码学笔记">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">Views: </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>此处会长期更新我做过的一些密码学题目。</p>
<hr>
<h1 id="RSA"><a href="#RSA" class="headerlink" title="RSA"></a><strong>RSA</strong></h1><p>一些基本知识：</p>
<p><strong>RSA中几个用到的字母：</strong><br>P : 大质数p<br>Q : 大质数q<br>N :  n=p*q<br>φ(n) = φ(p) * φ(q) = (p − 1)(q − 1) = n − (p + q − 1)<br>e : encryption key (public key) (又称加密指数)<br>d : decryption key (private key)  e对于φ(n)的模反元素<br>c : ciphertext<br>m：message（m &lt; n）</p>
<p><strong>主要公式：</strong><br>$c ≡ m^e \pmod{n}$<br>$m ≡ c^d \pmod{n}$</p>
<p><strong>欧拉函数</strong>：φ(n)是小于等于n的数中与n互质的数的数目。<br>欧拉函数是积性函数——若p,q互质，φ(p<em>q)= φ(p) </em>φ(q)<br>若p为质数，则φ(p)=p-1<br><a id="more"></a></p>
<p><strong>同余定理</strong>：给定一个正整数m，如果两个整数a和b满足（a-b）能够被m整除，即（a-b）/m得到一个整数，那么就称整数a与b对模m同余，记作a≡b(mod m)。<br>性质： 1 反身性 a≡a (mod m)<br>2 对称性 若a≡b(mod m)，则b≡a (mod m)<br>3 传递性 若a≡b (mod m)，b≡c (mod m)，则a≡c (mod m)<br>4 同余式相加 若a≡b (mod m)，c≡d(mod m)，则a+-c≡b+-d (mod m)<br>5 同余式相乘 若a≡b (mod m)，c≡d(mod m)，则ac≡bd (mod m)</p>
<p><strong>模反元素</strong>：指有一个整数d，可以使得e<em>d被φ(n)除的余数为1，即e</em>d ≡ 1 (mod φ(n))，这个式子等于e<em>d - 1 = k</em>φ(n)</p>
<p><strong>快速幂取模</strong>：python实现<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">modexp</span><span class="params">(c,d,n)</span>:</span><span class="comment">#等价于自带的pow(c,d,n)</span></span><br><span class="line">	ret=<span class="number">1</span></span><br><span class="line">	<span class="keyword">while</span> d&gt;<span class="number">0</span>:</span><br><span class="line">		c=c%n</span><br><span class="line">		<span class="keyword">if</span> d&amp;<span class="number">1</span>:</span><br><span class="line">			ret=(ret*c)%n</span><br><span class="line">		d&gt;&gt;=<span class="number">1</span></span><br><span class="line">		c=(c*c)%n</span><br><span class="line">	<span class="keyword">return</span> ret</span><br></pre></td></tr></table></figure></p>
<p><strong>在linux上使用openssl解密的</strong>：<br>安装环境：<br>sudo -i apt-get install  libgmp3-dev<br>sudo -i pip install gmpy<br>sudo -i pip install pyasn1</p>
<p><strong>rsatool.py</strong>:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python2</span></span><br><span class="line"><span class="keyword">import</span> base64, fractions, optparse, random</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="keyword">import</span> gmpy</span><br><span class="line"><span class="keyword">except</span> ImportError <span class="keyword">as</span> e:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">import</span> gmpy2 <span class="keyword">as</span> gmpy</span><br><span class="line">    <span class="keyword">except</span> ImportError:</span><br><span class="line">        <span class="keyword">raise</span> e</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pyasn1.codec.der <span class="keyword">import</span> encoder</span><br><span class="line"><span class="keyword">from</span> pyasn1.type.univ <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">PEM_TEMPLATE = <span class="string">'-----BEGIN RSA PRIVATE KEY-----\n%s-----END RSA PRIVATE KEY-----\n'</span></span><br><span class="line">DEFAULT_EXP = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">factor_modulus</span><span class="params">(n, d, e)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    Efficiently recover non-trivial factors of n</span></span><br><span class="line"><span class="string">    See: Handbook of Applied Cryptography</span></span><br><span class="line"><span class="string">    8.2.2 Security of RSA -&gt; (i) Relation to factoring (p.287)</span></span><br><span class="line"><span class="string">    http://www.cacr.math.uwaterloo.ca/hac/</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    t = (e * d - <span class="number">1</span>)</span><br><span class="line">    s = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">        quotient, remainder = divmod(t, <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> remainder != <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        s += <span class="number">1</span></span><br><span class="line">        t = quotient</span><br><span class="line"></span><br><span class="line">    found = <span class="keyword">False</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">not</span> found:</span><br><span class="line">        i = <span class="number">1</span></span><br><span class="line">        a = random.randint(<span class="number">1</span>,n<span class="number">-1</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> i &lt;= s <span class="keyword">and</span> <span class="keyword">not</span> found:</span><br><span class="line">            c1 = pow(a, pow(<span class="number">2</span>, i<span class="number">-1</span>, n) * t, n)</span><br><span class="line">            c2 = pow(a, pow(<span class="number">2</span>, i, n) * t, n)</span><br><span class="line"></span><br><span class="line">            found = c1 != <span class="number">1</span> <span class="keyword">and</span> c1 != (<span class="number">-1</span> % n) <span class="keyword">and</span> c2 == <span class="number">1</span></span><br><span class="line"></span><br><span class="line">            i += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    p = fractions.gcd(c1<span class="number">-1</span>, n)</span><br><span class="line">    q = (n / p)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> p, q</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RSA</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, p=None, q=None, n=None, d=None, e=DEFAULT_EXP)</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        Initialize RSA instance using primes (p, q)</span></span><br><span class="line"><span class="string">        or modulus and private exponent (n, d)</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line"></span><br><span class="line">        self.e = e</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> p <span class="keyword">and</span> q:</span><br><span class="line">            <span class="keyword">assert</span> gmpy.is_prime(p), <span class="string">'p is not prime'</span></span><br><span class="line">            <span class="keyword">assert</span> gmpy.is_prime(q), <span class="string">'q is not prime'</span></span><br><span class="line"></span><br><span class="line">            self.p = p</span><br><span class="line">            self.q = q</span><br><span class="line">        <span class="keyword">elif</span> n <span class="keyword">and</span> d:   </span><br><span class="line">            self.p, self.q = factor_modulus(n, d, e)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">raise</span> ArgumentError(<span class="string">'Either (p, q) or (n, d) must be provided'</span>)</span><br><span class="line"></span><br><span class="line">        self._calc_values()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_calc_values</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.n = self.p * self.q</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> self.p != self.q:</span><br><span class="line">            phi = (self.p - <span class="number">1</span>) * (self.q - <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            phi = (self.p ** <span class="number">2</span>) - self.p</span><br><span class="line"></span><br><span class="line">        self.d = gmpy.invert(self.e, phi)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># CRT-RSA precomputation</span></span><br><span class="line">        self.dP = self.d % (self.p - <span class="number">1</span>)</span><br><span class="line">        self.dQ = self.d % (self.q - <span class="number">1</span>)</span><br><span class="line">        self.qInv = gmpy.invert(self.q, self.p)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">to_pem</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        Return OpenSSL-compatible PEM encoded key</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        <span class="keyword">return</span> (PEM_TEMPLATE % base64.encodestring(self.to_der()).decode()).encode()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">to_der</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        Return parameters as OpenSSL compatible DER encoded key</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        seq = Sequence()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> x <span class="keyword">in</span> [<span class="number">0</span>, self.n, self.e, self.d, self.p, self.q, self.dP, self.dQ, self.qInv]:</span><br><span class="line">            seq.setComponentByPosition(len(seq), Integer(x))</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> encoder.encode(seq)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">dump</span><span class="params">(self, verbose)</span>:</span></span><br><span class="line">        vars = [<span class="string">'n'</span>, <span class="string">'e'</span>, <span class="string">'d'</span>, <span class="string">'p'</span>, <span class="string">'q'</span>]</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> verbose:</span><br><span class="line">            vars += [<span class="string">'dP'</span>, <span class="string">'dQ'</span>, <span class="string">'qInv'</span>]</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> v <span class="keyword">in</span> vars:</span><br><span class="line">            self._dumpvar(v)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_dumpvar</span><span class="params">(self, var)</span>:</span></span><br><span class="line">        val = getattr(self, var)</span><br><span class="line"></span><br><span class="line">        parts = <span class="keyword">lambda</span> s, l: <span class="string">'\n'</span>.join([s[i:i+l] <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, len(s), l)])</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> len(str(val)) &lt;= <span class="number">40</span>:</span><br><span class="line">            print(<span class="string">'%s = %d (%#x)\n'</span> % (var, val, val))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            print(<span class="string">'%s ='</span> % var)</span><br><span class="line">            print(parts(<span class="string">'%x'</span> % val, <span class="number">80</span>) + <span class="string">'\n'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    parser = optparse.OptionParser()</span><br><span class="line"></span><br><span class="line">    parser.add_option(<span class="string">'-p'</span>, dest=<span class="string">'p'</span>, help=<span class="string">'prime'</span>, type=<span class="string">'int'</span>)</span><br><span class="line">    parser.add_option(<span class="string">'-q'</span>, dest=<span class="string">'q'</span>, help=<span class="string">'prime'</span>, type=<span class="string">'int'</span>)</span><br><span class="line">    parser.add_option(<span class="string">'-n'</span>, dest=<span class="string">'n'</span>, help=<span class="string">'modulus'</span>, type=<span class="string">'int'</span>)</span><br><span class="line">    parser.add_option(<span class="string">'-d'</span>, dest=<span class="string">'d'</span>, help=<span class="string">'private exponent'</span>, type=<span class="string">'int'</span>)</span><br><span class="line">    parser.add_option(<span class="string">'-e'</span>, dest=<span class="string">'e'</span>, help=<span class="string">'public exponent (default: %d)'</span> % DEFAULT_EXP, type=<span class="string">'int'</span>, default=DEFAULT_EXP)</span><br><span class="line">    parser.add_option(<span class="string">'-o'</span>, dest=<span class="string">'filename'</span>, help=<span class="string">'output filename'</span>)</span><br><span class="line">    parser.add_option(<span class="string">'-f'</span>, dest=<span class="string">'format'</span>, help=<span class="string">'output format (DER, PEM) (default: PEM)'</span>, type=<span class="string">'choice'</span>, choices=[<span class="string">'DER'</span>, <span class="string">'PEM'</span>], default=<span class="string">'PEM'</span>)</span><br><span class="line">    parser.add_option(<span class="string">'-v'</span>, dest=<span class="string">'verbose'</span>, help=<span class="string">'also display CRT-RSA representation'</span>, action=<span class="string">'store_true'</span>, default=<span class="keyword">False</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        (options, args) = parser.parse_args()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> options.p <span class="keyword">and</span> options.q:</span><br><span class="line">            print(<span class="string">'Using (p, q) to initialise RSA instance\n'</span>)</span><br><span class="line">            rsa = RSA(p=options.p, q=options.q, e=options.e)</span><br><span class="line">        <span class="keyword">elif</span> options.n <span class="keyword">and</span> options.d:</span><br><span class="line">            print(<span class="string">'Using (n, d) to initialise RSA instance\n'</span>)</span><br><span class="line">            rsa = RSA(n=options.n, d=options.d, e=options.e)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            parser.print_help()</span><br><span class="line">            parser.error(<span class="string">'Either (p, q) or (n, d) needs to be specified'</span>)</span><br><span class="line"></span><br><span class="line">        rsa.dump(options.verbose)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> options.filename:</span><br><span class="line">            print(<span class="string">'Saving %s as %s'</span> % (options.format, options.filename))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> options.format == <span class="string">'PEM'</span>:</span><br><span class="line">                data = rsa.to_pem()</span><br><span class="line">            <span class="keyword">elif</span> options.format == <span class="string">'DER'</span>:</span><br><span class="line">                data = rsa.to_der()</span><br><span class="line"></span><br><span class="line">            fp = open(options.filename, <span class="string">'wb'</span>)</span><br><span class="line">            fp.write(data)</span><br><span class="line">            fp.close()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">except</span> optparse.OptionValueError <span class="keyword">as</span> e:</span><br><span class="line">        parser.print_help()</span><br><span class="line">        parser.error(e.msg)</span><br></pre></td></tr></table></figure></p>
<p><strong>openssl 语句</strong>：<br>从公钥中读取e和n：openssl   rsa -pubin -text -modulus -in warmup -in 【public.pem】<br>Rsatool.py生成指定的私钥：python rsatool.py -o 【private.pem】 -e 【65537】 -p 【123】-q 【123】<br>用私钥解密：openssl rsautl -decrypt -in 【flag.enc】 -inkey 【private.pem】</p>
<h2 id="啥都知道类"><a href="#啥都知道类" class="headerlink" title="啥都知道类"></a>啥都知道类</h2><p>只要了解RSA的基本运作原理就可以解密了。</p>
<p>例题：HCTF GAME 密码学教室入门（一）</p>
<p>题目描述：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">p:0x9a724c6747de9eadccd33f4d60ada91754b8be8c65590cafe66f69a2f4afbfd359e47ca6fd2dbde8948062dc116bc574f4313ab99b2bb6d8ae47beaa0c1ebeddL</span><br><span class="line"></span><br><span class="line">q:0x8c1c81cc005ce3dd6d684ebb88151dc0c53b1cef8a29b1cb8121860fb57d93117bf449aac4300dc6103ac6211c6f8ae68987d99aff0dd8967a4afa00f2116873L</span><br><span class="line"></span><br><span class="line">e:0x190a000845e9c8c2059242835432326369aaf8c7ca85e685bba968b386155a91f1f7ca1019ff23d119222e1f0dfdeb0915d2e97601ef94bf15ca6d9211e984e9038f263f4984355c397ed22d67c26da6d31acfc4d599c70cba80859bee099e5a2dc3ab23aecf58f73f44d07318f70985c623d9612efefb15bf8dab77d5d54e85L</span><br><span class="line"></span><br><span class="line">d:0x28b95b7e3159a851cbf537e007ae49864b7dbb93fc370a5L </span><br><span class="line"></span><br><span class="line">c:0x23091e42fa7609c73f1941b320fad6d2ff6e47be588d1623f970f1fee7abd221c9834b208f3c888902fe87ca76ec1e1363757d93c6e25c49f1c61c72b141c0b8848b54a117427d8e30eeab89694eb5f849cafecb0e5361b9b2b0e3f89e0fdbcc66a6aad4a1a4a85d828083a01a5d569b7eeb6f9151794453382b524aa52993f9L</span><br></pre></td></tr></table></figure></p>
<p>不解释，用python写个脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">c=<span class="number">0x23091e42fa7609c73f1941b320fad6d2ff6e47be588d1623f970f1fee7abd221c9834b208f3c888902fe87ca76ec1e1363757d93c6e25c49f1c61c72b141c0b8848b54a117427d8e30eeab89694eb5f849cafecb0e5361b9b2b0e3f89e0fdbcc66a6aad4a1a4a85d828083a01a5d569b7eeb6f9151794453382b524aa52993f9</span></span><br><span class="line">d=<span class="number">0x28b95b7e3159a851cbf537e007ae49864b7dbb93fc370a5</span></span><br><span class="line">n=<span class="number">0x9a724c6747de9eadccd33f4d60ada91754b8be8c65590cafe66f69a2f4afbfd359e47ca6fd2dbde8948062dc116bc574f4313ab99b2bb6d8ae47beaa0c1ebedd</span> * <span class="number">0x8c1c81cc005ce3dd6d684ebb88151dc0c53b1cef8a29b1cb8121860fb57d93117bf449aac4300dc6103ac6211c6f8ae68987d99aff0dd8967a4afa00f2116873</span></span><br><span class="line"></span><br><span class="line">m=pow(c,d,n)</span><br><span class="line"><span class="keyword">print</span> hex(m)[<span class="number">2</span>:len(hex(m))<span class="number">-1</span>].decode(<span class="string">'hex'</span>)</span><br></pre></td></tr></table></figure>
<p>flag:<code>hgame{rsa_1s_v3ry_e4sy!}</code></p>
<h2 id="吓唬人类"><a href="#吓唬人类" class="headerlink" title="吓唬人类"></a>吓唬人类</h2><p>表面上是个RSA，其实根本没加密。</p>
<p>例题：HCTF GAME 密码学教室入门（四）</p>
<p>题目描述：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">n: 0x81cfc71c44c83faf3c5242fa81ae2e533fc945f3bef30bc13323ea4a55b3debc11301c6a9ecb8f7ef92fa169b157435af728a145497f2cdf75b3007b9732da4c47d67683f09ae1edc8f698f5ec7549593d9f1d06adafae4ad09514928bf0367a2719f7c171580318690dafc6a3d5385b3516b769f529c0a055ce25e68bc21395L</span><br><span class="line">e: 0x01</span><br><span class="line">c: 0x6867616d657b7273615f31735f737469316c5f653473795f6e6f77217dL</span><br></pre></td></tr></table></figure></p>
<p>注意到e=1，$c ≡ m^e * (\mod n)$，所以c ≡ m mod n，又因为n远大于c，所以m=c。</p>
<p>python：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">print</span> <span class="string">'6867616d657b7273615f31735f737469316c5f653473795f6e6f77217d'</span>.decode(<span class="string">'hex'</span>)</span><br></pre></td></tr></table></figure></p>
<p>flag:<code>hgame{rsa_1s_sti1l_e4sy_now!}</code></p>
<h2 id="n能被工具快速分解类"><a href="#n能被工具快速分解类" class="headerlink" title="n能被工具快速分解类"></a>n能被工具快速分解类</h2><p><strong>两个常用的工具</strong>：<br>在线分解大质数（不一定都能成功分解）：<a href="http://factordb.com/" target="_blank" rel="noopener">http://factordb.com/</a><br>windows工具：<a href="https://sourceforge.net/projects/yafu/" target="_blank" rel="noopener">yafu</a></p>
<p>将n成功分解得到p,q。由p,q,e模反求得d。最后c,d,n求m。</p>
<p>例题：HCTF GAME 密码学教室进阶（五）</p>
<p>题目描述：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">n = <span class="number">0xee290c7a603fc23300eb3f0e5868d056b7deb1af33b5112a6da1edc9612c5eeb4ab07d838a3b4397d8e6b6844065d98543a977ed40ccd8f57ac5bc2daee2dec301aac508f9befc27fae4a2665e82f13b1ddd17d3a0c85740bed8d53eeda665a5fc1bed35fbbcedd4279d04aa747ac1f996f724b14f0228366aeae34305152e1f430221f9594497686c9f49021d833144962c2a53dbb47bdbfd19785ad8da6e7b59be24d34ed201384d3b0f34267df4ba8b53f0f4481f9bd2e26c4a3e95cd1a47f806a1f16b86a9fc5e8a0756898f63f5c9144f51b401ba0dd5ad58fb0e97ebac9a41dc3fb4a378707f7210e64c131bca19bd54e39bbfa0d7a0e7c89d955b1c9fL</span></span><br><span class="line"></span><br><span class="line">e = <span class="number">0xe438fddb77f9bc2cf97185041e8a5ce8d0853cbfb657b940505870f0d3dfc0b723c5f7c8c9b940769f358397e275d00cce1cf760f9892a4b83ff90cbe513c6cc450258d02bcee33e499fb028c2b0d811bba22ef0c4fea314018d4943451ecdeb5d6e98bd5ed71ab7862a747f851c532aeae6c29f52c3f9be649a4142810ddb83015386fd035fcdc28059236135a9cce24fd650062067dcf43f5dcf24e15f132e9dca4ff68cc7637139dbdba276157f11e8af118d8dfae3f811a0377ba37555f9L</span></span><br><span class="line"></span><br><span class="line">c = <span class="number">0xbe864c22e69bd872541b7538b3c9797cf76afa2b2cac70c5a1a47fb6b6046daf345946d6e0eb299d12a7485ad9edaced28ef0b3169a22d1cba69c1e556ed2a69b6eca7e030f8cf61616faff4e063caf1a0668d4357594e7ff8887f00f61df5161e94f2197abcc2d34db666a34fa9e0f108c7937dc09b8e091ba2a4180f88f1b58229891bd619025f2c13f5758d7f4f6ac8f4d3f565449a730fef9ecee37f5409b801b554a30cfb42f69afc734b7709c5df6618e94e96b5d24a4b63cd1907296ae9bbd36084bad58c5e5cb3d275c953efc73aff595f36d92e182d6705fee14dabd29df53735132249d5935f8e780210359d67ab80ac2dfa29a88a5f585cbda8bbL</span></span><br></pre></td></tr></table></figure></p>
<p>上factordb成功分解：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">p=<span class="number">57970027</span></span><br><span class="line">q=<span class="number">518629368090170828331048663550229634444384299751272939077168648935075604180676006392464524953128293842996441022771890719731811852948684950388211907532651941639114462313594608747413310447500790775078081191686616804987790818396104388332734677935684723647108960882771460341293023764117182393730838418468480006985768382115446225422781116531906323045161803441960506496275763429558238732127362521949515590606221409745127192859630468854653290302491063292735496286233738504010613373838035073995140744724948933839238851600638652315655508861728439180988253324943039367876070687033249730660337593825389358874152757864093</span></span><br></pre></td></tr></table></figure></p>
<p>python模反：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">egcd</span><span class="params">(a, b)</span>:</span></span><br><span class="line">	<span class="keyword">if</span> a == <span class="number">0</span>:</span><br><span class="line">		<span class="keyword">return</span> (b, <span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		g, y, x = egcd(b % a, a)</span><br><span class="line">		<span class="keyword">return</span> (g, x - (b // a) * y, y)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">modinv</span><span class="params">(a, m)</span>:</span></span><br><span class="line">	g, x, y = egcd(a, m)</span><br><span class="line">	<span class="keyword">if</span> g != <span class="number">1</span>:</span><br><span class="line">		<span class="keyword">raise</span> Exception(<span class="string">'modular inverse does not exist'</span>)</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		<span class="keyword">return</span> x % m</span><br><span class="line"></span><br><span class="line">e=<span class="number">0xe438fddb77f9bc2cf97185041e8a5ce8d0853cbfb657b940505870f0d3dfc0b723c5f7c8c9b940769f358397e275d00cce1cf760f9892a4b83ff90cbe513c6cc450258d02bcee33e499fb028c2b0d811bba22ef0c4fea314018d4943451ecdeb5d6e98bd5ed71ab7862a747f851c532aeae6c29f52c3f9be649a4142810ddb83015386fd035fcdc28059236135a9cce24fd650062067dcf43f5dcf24e15f132e9dca4ff68cc7637139dbdba276157f11e8af118d8dfae3f811a0377ba37555f9</span></span><br><span class="line">p=<span class="number">57970027</span></span><br><span class="line">q=<span class="number">518629368090170828331048663550229634444384299751272939077168648935075604180676006392464524953128293842996441022771890719731811852948684950388211907532651941639114462313594608747413310447500790775078081191686616804987790818396104388332734677935684723647108960882771460341293023764117182393730838418468480006985768382115446225422781116531906323045161803441960506496275763429558238732127362521949515590606221409745127192859630468854653290302491063292735496286233738504010613373838035073995140744724948933839238851600638652315655508861728439180988253324943039367876070687033249730660337593825389358874152757864093</span></span><br><span class="line"></span><br><span class="line">d=modinv(e,(p<span class="number">-1</span>)*(q<span class="number">-1</span>))</span><br><span class="line"></span><br><span class="line">print(d)</span><br></pre></td></tr></table></figure></p>
<p>解得d：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">d=<span class="number">12992115738506970540841649209878923850449850256938220982758830156637205612762035155282226327685920931284918421552064382225983813981014872739551419060382854503642590330353164882512391318500353428642008085236106734064291092981546537314015444185586142992938345877421430131346693442575558546897860918057428050551689499978084803855243769401293926790504832562795137719424038069153683270022346974394431002503195605976824311455435505098340184475009365363490476873157045002222791446505348037665177173433292491281964806330443250471290739357059963205400702250838949527437626820311142744601192434198274561316384331263223868573905</span></span><br></pre></td></tr></table></figure></p>
<p>python解密：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">c=<span class="number">0xbe864c22e69bd872541b7538b3c9797cf76afa2b2cac70c5a1a47fb6b6046daf345946d6e0eb299d12a7485ad9edaced28ef0b3169a22d1cba69c1e556ed2a69b6eca7e030f8cf61616faff4e063caf1a0668d4357594e7ff8887f00f61df5161e94f2197abcc2d34db666a34fa9e0f108c7937dc09b8e091ba2a4180f88f1b58229891bd619025f2c13f5758d7f4f6ac8f4d3f565449a730fef9ecee37f5409b801b554a30cfb42f69afc734b7709c5df6618e94e96b5d24a4b63cd1907296ae9bbd36084bad58c5e5cb3d275c953efc73aff595f36d92e182d6705fee14dabd29df53735132249d5935f8e780210359d67ab80ac2dfa29a88a5f585cbda8bb</span></span><br><span class="line">d=<span class="number">12992115738506970540841649209878923850449850256938220982758830156637205612762035155282226327685920931284918421552064382225983813981014872739551419060382854503642590330353164882512391318500353428642008085236106734064291092981546537314015444185586142992938345877421430131346693442575558546897860918057428050551689499978084803855243769401293926790504832562795137719424038069153683270022346974394431002503195605976824311455435505098340184475009365363490476873157045002222791446505348037665177173433292491281964806330443250471290739357059963205400702250838949527437626820311142744601192434198274561316384331263223868573905</span></span><br><span class="line">n=<span class="number">0xee290c7a603fc23300eb3f0e5868d056b7deb1af33b5112a6da1edc9612c5eeb4ab07d838a3b4397d8e6b6844065d98543a977ed40ccd8f57ac5bc2daee2dec301aac508f9befc27fae4a2665e82f13b1ddd17d3a0c85740bed8d53eeda665a5fc1bed35fbbcedd4279d04aa747ac1f996f724b14f0228366aeae34305152e1f430221f9594497686c9f49021d833144962c2a53dbb47bdbfd19785ad8da6e7b59be24d34ed201384d3b0f34267df4ba8b53f0f4481f9bd2e26c4a3e95cd1a47f806a1f16b86a9fc5e8a0756898f63f5c9144f51b401ba0dd5ad58fb0e97ebac9a41dc3fb4a378707f7210e64c131bca19bd54e39bbfa0d7a0e7c89d955b1c9f</span></span><br><span class="line">m=pow(c,d,n)</span><br><span class="line"><span class="keyword">print</span> hex(m)[<span class="number">2</span>:len(hex(m))<span class="number">-1</span>].decode(<span class="string">'hex'</span>)</span><br></pre></td></tr></table></figure>
<p>flag:<code>hgame{1f_u_kn0w_p_q_1n_RSA_1t_is_easy___}</code></p>
<h2 id="多个n有公约数分解类"><a href="#多个n有公约数分解类" class="headerlink" title="多个n有公约数分解类"></a>多个n有公约数分解类</h2><p>还是对n的分解，只是和上面分解n的方法不同。这类题给了许多组MD5加密，有一个特点就是他们的q是相同的（p不同）。</p>
<p>运用gcd求出q，然后p=n/q求得p，然后老套路。</p>
<p>例题：HCTF GAME 进击的 Crypto [0]</p>
<p>题目描述（原题给了10组，我们只取前两组即可）：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">n <span class="keyword">is</span> <span class="number">28989197955870674811941817152881961892555962828020048566215146047714999804743571465320756664500939106612607504133407755470924915037883788416084924998195415611009578161228226056524027626453567996030151847302248848345942762209886902216532270655286303624781479379460319335849225128417295447574269158603952744753408534894136230960676590980945838733350143370605144754932401806068003166087495356366335014736018745371974324955357717635855207674309628146381030418983172039685916675081977078212813718313201568394044637347955108623458947913411108888733982376607647705302281273170230540579872437433435253235534772724624778056181</span></span><br><span class="line">e <span class="keyword">is</span> <span class="number">65537</span></span><br><span class="line">c <span class="keyword">is</span> <span class="number">14200655400630956617529154837540349350095534430543196299987252783320359338882400858000649938298574946882176873795065987640380185922571487987903069796872680567596754211592988768630729844485795253975027297563832927176988502771266530781452168489731952873297707254669904609865565861351429459102567318447934677565870915603816516557032164955329497823771897899211076176905132170360842951444390670253036307048815943908305457043184642918674003085039564350070641592716116089015861491205237748561298604957423077954850396167621218521884114394431799317165818964438359695744604198246716410783223931430682808151056020475306791729591</span></span><br><span class="line"></span><br><span class="line">n <span class="keyword">is</span> <span class="number">29703811006265969568420235185761287243393105045336995893094671661145408859269297497044834735198371987472186770953203812235003929122122129964989222762478116003185582578013431109127657242169359697936471497781547555222392181694624446976869099519331688628488881595076878345856808384797954271081176432330698334469596003760530797898645529616535584139559768170011693043197581376652770244664582733792825511473683193195672487559140733668442863818306947800631472845430628311685792799840854080385208783178691512540436222290062939858472754953657763052720510548438848633979413756332920634307585878271699119574149435107725143578613</span></span><br><span class="line">e <span class="keyword">is</span> <span class="number">65537</span></span><br><span class="line">c <span class="keyword">is</span> <span class="number">4578343924026570978472440931890325318245466288503599188533732998304051832656861172828218449138067382663459418589454854723253403947485557649615240187148291946554256687236506349553390057789720132702311963022032912389266835192465297150080916409872411988524410949952643478505491642457481045586019802683635095575472601541635397816830552539347027587330022646372943452066068029168471475125499435879399193076604330172042202401974524486727842888375820659903161039255979785711025431762267505041403586092799995451754527655054098031095440553010856162282818464431911828926227552966047893177859591679867661412947560702301353393344</span></span><br></pre></td></tr></table></figure></p>
<p>python分解n：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gcd</span><span class="params">(a, b)</span>:</span></span><br><span class="line">	<span class="keyword">if</span> a &lt; b:</span><br><span class="line">		a, b = b, a</span><br><span class="line"> </span><br><span class="line">	<span class="keyword">while</span> b != <span class="number">0</span>:</span><br><span class="line">		temp = a % b</span><br><span class="line">		a = b</span><br><span class="line">		b = temp</span><br><span class="line"> </span><br><span class="line"> 	<span class="keyword">return</span> a</span><br><span class="line"></span><br><span class="line">n1 = <span class="number">28989197955870674811941817152881961892555962828020048566215146047714999804743571465320756664500939106612607504133407755470924915037883788416084924998195415611009578161228226056524027626453567996030151847302248848345942762209886902216532270655286303624781479379460319335849225128417295447574269158603952744753408534894136230960676590980945838733350143370605144754932401806068003166087495356366335014736018745371974324955357717635855207674309628146381030418983172039685916675081977078212813718313201568394044637347955108623458947913411108888733982376607647705302281273170230540579872437433435253235534772724624778056181</span></span><br><span class="line">n2 = <span class="number">29703811006265969568420235185761287243393105045336995893094671661145408859269297497044834735198371987472186770953203812235003929122122129964989222762478116003185582578013431109127657242169359697936471497781547555222392181694624446976869099519331688628488881595076878345856808384797954271081176432330698334469596003760530797898645529616535584139559768170011693043197581376652770244664582733792825511473683193195672487559140733668442863818306947800631472845430628311685792799840854080385208783178691512540436222290062939858472754953657763052720510548438848633979413756332920634307585878271699119574149435107725143578613</span></span><br><span class="line"></span><br><span class="line">p = gcd(n1,n2)</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> p,<span class="string">"\n\n"</span>,n1 // p</span><br></pre></td></tr></table></figure></p>
<p>解得n1下的p,q:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">p=<span class="number">174020591931642579445639482520669966832472464887563376831648240313949745675620951449596182091422504516152964331753172816101258786500867442499980329622871605643244312864569190912571594622928685486487082899631190828171757188986378429230898856002204891580815930976676783807695195461562646917675429591266528741337</span> </span><br><span class="line"></span><br><span class="line">q=<span class="number">166584871560820727096589642347689679565074855614352117551421403470172486999617714211766560053113999351102121040050712302652946259905787937498701699126275189937913458623225733035633870625681735432630656542758649284674875757423561657674667345174775248412119912423941445877761025122933990376999367161895532332413</span></span><br></pre></td></tr></table></figure></p>
<p>老套路，模反求d，pow求m，不在写过程了，flag：<code>hctf{I7_1s_d4nger0us_2_Sh4re_prim3}</code></p>
<h2 id="低加密指数广播攻击类"><a href="#低加密指数广播攻击类" class="headerlink" title="低加密指数广播攻击类"></a>低加密指数广播攻击类</h2><p>看题目的话和上面很像，都是给了很多组的RSA，但这个类型有一个特点，就是e很小且相同。</p>
<p>如果选取的加密指数较低，并且使用了相同的加密指数给一个接受者的群发送相同的信息，那么可以进行广播攻击得到明文。</p>
<p>例题：HCTF GAME 进击的 Crypto [5]</p>
<p>题目描述：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">n <span class="keyword">is</span> <span class="number">17551188754807399016342420221734945766749930201727412345251590531404061480740932995199065332987719183197199448336435851015540272155441486746027315107821340969105623451575872580170978368650593880274076025520453956378539766228430429142117994616985318963125739076826635459215114946159348678398268099389525414431618517743889314085714390430972783223270985688988995257770363117225472590084489120958397189130958462784532637453482182763505791720641422686749616216521724012108378680177131928438795893866425040489551258902610047574579899692834984999209528110849342042529825594061894238371591910354584305136154355365191215400149</span></span><br><span class="line">e <span class="keyword">is</span> <span class="number">10</span></span><br><span class="line">c <span class="keyword">is</span> <span class="number">4675182605549711347653299514777826238559040200527747810846901991433127025723361807211672208052862870258047285285949212515664278410499603829663266213968511493974766674071825225536665267049044619340378438531615983696406305841945756396579371794826265549929503043134668360055027276522368879193620937457881486509311711905722483187734650127796510808637890189952840971330768913946884525594627652458745930532219238258911608744112001798136394806004726472890838481881026716605743812674350955258003794590748258523929460446986020794445478076559635145181909093786617716473870604463315696183050495143502762614767485881979217577416</span></span><br><span class="line"></span><br><span class="line">n <span class="keyword">is</span> <span class="number">21840437284422601584177601857355845296420300157767339109572377640408362726674561246210400400760474187121246893712480109326893614162779470768415282900713800983815570602250068673695044749932532689851310770087552524620857623442019428044482787965428075984951982104920901562456426672111590909100736209153905853035127247720276974050404663847547090362780729077829594684995979457326414947449083219461617302643392904522733812903141301332227357689517880801845510579518887472928083718826890369016944549160461428710615747001273521253638766267143341819170249648385341127263707417642925464809788975715332938666417316695941347477577</span></span><br><span class="line">e <span class="keyword">is</span> <span class="number">10</span></span><br><span class="line">c <span class="keyword">is</span> <span class="number">4586033930015814975553487614321341290358072960539564849589758593801587823414394351862074093343255479635303199078561905260793645869942622136164615776822867275172888812989071016687658023005838776181437470204528335444413852561895603377955959308318399246963213964044984235974352824060625970587119586612774322385216810264819426458641852166009899106655036755913322283219739741020656812034348404092018340277026844114272699170323014050087289715403989671918767712613414346320222745328800096615947138667139053339483278319521201983885423491905171167675501563556563890821756892474999549635650486944010346554641603343238490572689</span></span><br><span class="line"></span><br><span class="line">n <span class="keyword">is</span> <span class="number">30015914133986758133105015082922460910471726819000479872816812806794140887209294393963063273377891203069864711466776200108173672428779293308320460116493040572826915020654293929241843686728296387400110062099074573009645563520805301899962344680821396200256042478539540675850427377958553324581371362112652752444824919601767821622038488365501031636558236126052654241662743070651213369566898998898634441261811655053789384588711547685939927721116404429914329081432990913321296964957260691148704710581681774562904924080813274984809940008968629515304859518629473284018332651831587916402539386242421630250537030688162675751761</span></span><br><span class="line">e <span class="keyword">is</span> <span class="number">10</span></span><br><span class="line">c <span class="keyword">is</span> <span class="number">12012575342366442210994368605032582129674485327006093552902983877957202172783938071684841031902396156899396879136388606996807608296316795628987877357547213450360953742947781700549506469226564975927361748596520878542651668963131021269851928174681007347771519569914690980744941965086762285630082781013781879511681353119117280354102271439057204066405072328422057721895983540492150402309552609035008272366176657384174081229798739099558539083074489500359062010164358300087124447037922844709870430218019673914305742939927888838599616520300011913022792060392260618046807788302643742874847024153198113792628046678578753632923</span></span><br><span class="line"></span><br><span class="line">n <span class="keyword">is</span> <span class="number">18009718435825445649372629634867772247035138229493108362713630947680338354227735572070882390378632440365163117094233413520107070581908224239210969172094402760924055334584259678276505919418191623762998249724248379302786621689049107500760348303940112840664926231345646325964133281550765454719628161600475143792567309947330130747860125557547051843620899629217636918002929846463097841539446014019579830347356084080488561917440356848465812937246809018168582635191619622041079012450531811237168105634382108634135880887093525611263186925213027913337454706919754923593714509998062073450679720905569489304398625255143801533277</span></span><br><span class="line">e <span class="keyword">is</span> <span class="number">10</span></span><br><span class="line">c <span class="keyword">is</span> <span class="number">4249005911324898630458723491151576810198619078332972911420166645127258598519950448507640904379342817486426262054889199369385257812524759761245588973651578211291344326619317559377360319507727729535083143293335799588196976241949218037833747839545295030259115279668065886560417877204054684495047181117075603468672292268831273735956964067626837975218539840667641885621426607941950306330198897187683754687379611844278471572791816397950634388907233312117920634807989734011132718334334850592111651631323130933438007008983489782601827321396168104668493332626558911838721998173148508994771473224050827471186478106896949413831</span></span><br><span class="line"></span><br><span class="line">n <span class="keyword">is</span> <span class="number">27090736422393991189249636552945539144039087911497773160371557650625344533254580764344628540515132884576739746597729079146155130899009238110101654711303800340566538298798432929136509923129089904647023409146264405964139002638684510681372633714179570768685640570209727600215295330846361754314973731753734397312932947433225732597524076563605729037998272803472953079912899867244318073144564355326520230078681106746670895643454939714423661018216469020021429142336238301775948794784776906058601395026463842070755547793192470653204078222827768950823747061655106900276571547680451953562314376913592896427730473091360051391129</span></span><br><span class="line">e <span class="keyword">is</span> <span class="number">10</span></span><br><span class="line">c <span class="keyword">is</span> <span class="number">18557109853898405974924769550105345673703067457537813607252151469933140760798378574244439559372100428971400070351173140348823652755825601433268832363575896137364288069984314151346137206115518309597389268875150549696376813277778514591532615794294637044626683931367510181612383681914421702261592233265455950023252407680604041046629667703207133146853618989187597749132650514038584280417791134426596848369417626039533740827554552117727501565841065077835398951826747855393552731497438983274201599740189743630949174610722118659019630964669901438690028070213710833335622573526403588737092869273969581607637522572757015237506</span></span><br><span class="line"></span><br><span class="line">n <span class="keyword">is</span> <span class="number">22277916445389799876692954866506052125036892596099795492064670519272419621528759837318253665292779127861537748967309681231938516330289846519214661138299205082421968922350230121526530080908053297879027158545040193774647350499415863211113776785399848472712293535289113810322398103983587423306282629848367328743089145940536913390664697321526306054579656600439140061667264516070003507841618352122567379038304294976725469305215682426898731699093794930417366769249256999177339843020364367769712776225743916112170787273891225926246407201080202593858063362565931942590349178361085396799890148505959437244983447934838792051793</span></span><br><span class="line">e <span class="keyword">is</span> <span class="number">10</span></span><br><span class="line">c <span class="keyword">is</span> <span class="number">19221531342713801219971420455098666365124810169512711030444063942333694562364114172361552139176582476168134219937393468391346535097965763785916484012657401095066804857900941482772687159471483908107669892419626059680168762119954068288719303591498504050604628627299671160225276355636519961578118413913001058744164531470610279168723402009469959377794138715204862239973561494796213624769358906726186769711689962808937828553399403173762034548974335960107700638910231658795639167906700770120741974418495196827830462542130080965552102416180517600397897065113788279096066792533807104187868678848857780735334749865813019681909</span></span><br><span class="line"></span><br><span class="line">n <span class="keyword">is</span> <span class="number">20851005254704933958354817552975190588383962843827122226904964048318053243049822277049715505735762051530592940514007687138882551369906711787133432792478447465241409449145625470766867280545673313710877827491010966285871747638401315338616986782370641881615238434667687936400955629642629748987839996011550408156162317201139746453148874558603034756902297066835592748562014100033050736650359512497633206350878620421058840864178654150287452573363251543090733404389037241843869379543719804499640600546216051812575335078292203435075056740907356476508423562893159958041443951220933694064510275964264723600894558623421819904501</span></span><br><span class="line">e <span class="keyword">is</span> <span class="number">10</span></span><br><span class="line">c <span class="keyword">is</span> <span class="number">2043866718532927301454127017521835945401727173760352488220517028498861777262807036566165189285730569375083406234212921588654098421290088269551352101830688429903600880691046607902396566775005694148315605616437713115424223594710186677844867273218443350479253279231960061845711898262461185970057002138523262952260834191169438764964758526877361442277664448596129451496415695776781879266732057920583336999766633938582656240607973759756021032489262381190762825081392613689817792764844409877116240223852376311404164963595040347176139494461319495285348608562589901671620063620688524249523700500144604558899272202564535295466</span></span><br><span class="line"></span><br><span class="line">n <span class="keyword">is</span> <span class="number">21745680718194037861694569863678082853797244380310200176477643943644972463871360669070584682807703870684830948023158889780219716829353665600564791257912082043905122048004593803193375178269942973208249276102769671038752489438400731535367257356207098737711096953679231300720903502192144476519811856646400822239966219746455729409375771797064825552958482297097797911599808242875799342438899636328763766908154658738969614707377852147843953614178305416594819846812426828300689497046389665982817209315784313108617753052015326937047712513569322963102500122038505770232917473260057408981125469607573191926134043719437868156273</span></span><br><span class="line">e <span class="keyword">is</span> <span class="number">10</span></span><br><span class="line">c <span class="keyword">is</span> <span class="number">9018406452041117867927204674649220929160509942604290572303644183451237944912470236367308266319079349289625873447647200474598755869642999213142758825809522474810817609751187533346902667225032452694187162262683056445775455963994237202296104812386374636270188433521927503415507963477240913270879794141170568393025367891003921090015993944946205723601349149601256727433716155121883420271498265967234259068535172501445643752691860997480636101699340740265505767091920668218018002976632111256430655619061247292025654740889077014179258647084698229733160071306390020603636210736363198302407289195286953980520285032528614492926</span></span><br><span class="line"></span><br><span class="line">n <span class="keyword">is</span> <span class="number">23257483042331781031320004066395973098539881870433034498180628292164825476845647596122889756396987220787263478778647199033523248861079487991256044473644515960559630792146394039814096408486541588067643811077716428015000310006227815563853161604153799667073262886506475792902392829571472354691875108497532721686076971371510238161060553858839091026451266521753830084143245517459861325880906431205328541736948784727909518259034781432825317588016829248046749554245422672923121452470552323438808591118050034108325754535134236727740460190849252647561826203675666601441506024780605194340777802389960180532831878689458096046821</span></span><br><span class="line">e <span class="keyword">is</span> <span class="number">10</span></span><br><span class="line">c <span class="keyword">is</span> <span class="number">17978671919734595201524186618868659656036765546673883938819333911564948587858876495802600244078413312462813938682090761599961604959609423010904187720748539707172853352540370208991902929002036775381503365170196838626379685712050728875172622632447875368166743751159775611642629408534890684109652648484868876710697249351895355111511281037497347712241242908563699707272843032773107477368790419109907271096351457526240471975122296483655337150130000812813081239181653384419149292970320991892073352340649237387406498087734708162094476092368665794350968924289259192893289337038201504066310173284757044802449600666007821509553</span></span><br><span class="line"></span><br><span class="line">n <span class="keyword">is</span> <span class="number">27637004622327338030988157906180324667829916751358977640832765328645718696385482091781513197472066052101704131751158627239657425473994441143385613105528200215275110466263289952962400664293602133856809475295970322767309563273999319926150648399522508592521685688896842833243324070987594588134776515978198364901455727292006058624015674914131447232032058875410956114939938460192876157612457774033922125553271809409381181134668696682847583314698759337802814876161751333701826176655372126746717533228292189928645064111959824895679517476699556313948724818860906006774808944802984477517788391260149504822396276593451707118257</span></span><br><span class="line">e <span class="keyword">is</span> <span class="number">10</span></span><br><span class="line">c <span class="keyword">is</span> <span class="number">8597067880812456123669594978660135058668875834924201279924162761020137582662367704504988576614934966062323191666982943113656186783894245035267051756178331490881264629774635620179678000947771928854566239213498586078670870127924696459041295848474073879336501325437194563845414699360564571136683492426292766799121155041276162673427700999761055592609213603158576637212003771003996722743170543342885011289692845493598413965688949325670519743413071479057382602222055902593614159427186017797992219490308930116850084553033461316509457834436420821916094206010206229370273622681413176347187252950087428868295965528772832409316</span></span><br></pre></td></tr></table></figure></p>
<p>m，e相同，不同的是c和n，有：<br>$c_1 \equiv m^e \mod n_1$<br>$c_2 \equiv m^e \mod n_2$<br>$c_3 \equiv m^e \mod n_3$<br>…<br>$c_n \equiv m^e \mod n_n$</p>
<p>由中国剩余定理，得：</p>
<p>$c_x \equiv m^n \mod n_1n_2n_3\cdot\cdot\cdot n_n$</p>
<p>python解密得：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">my_parse_number</span><span class="params">(number)</span>:</span></span><br><span class="line">    string = <span class="string">"%x"</span> % number</span><br><span class="line">    erg = []</span><br><span class="line">    <span class="keyword">while</span> string != <span class="string">''</span>:</span><br><span class="line">        erg = erg + [chr(int(string[:<span class="number">2</span>], <span class="number">16</span>))]</span><br><span class="line">        string = string[<span class="number">2</span>:]</span><br><span class="line">    <span class="keyword">return</span> <span class="string">''</span>.join(erg)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">e_gcd</span><span class="params">(a, b)</span>:</span></span><br><span class="line">    x,y = <span class="number">0</span>, <span class="number">1</span></span><br><span class="line">    lastx, lasty = <span class="number">1</span>, <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> b:</span><br><span class="line">        a, (q, b) = b, divmod(a,b)</span><br><span class="line">        x, lastx = lastx-q*x, x</span><br><span class="line">        y, lasty = lasty-q*y, y</span><br><span class="line">    <span class="keyword">return</span> (lastx, lasty, a)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">chinese_remainder_theorem</span><span class="params">(items)</span>:</span></span><br><span class="line">  N = <span class="number">1</span></span><br><span class="line">  <span class="keyword">for</span> a, n <span class="keyword">in</span> items:</span><br><span class="line">    N *= n</span><br><span class="line"></span><br><span class="line">  result = <span class="number">0</span></span><br><span class="line">  <span class="keyword">for</span> a, n <span class="keyword">in</span> items:</span><br><span class="line">    m = N/n</span><br><span class="line">    r, s, d = e_gcd(n, m)</span><br><span class="line">    <span class="keyword">if</span> d != <span class="number">1</span>:</span><br><span class="line">      <span class="keyword">raise</span> <span class="string">"Input not pairwise co-prime"</span></span><br><span class="line">    result += a*s*m</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> result % N, N</span><br><span class="line"></span><br><span class="line">e=<span class="number">10</span></span><br><span class="line"></span><br><span class="line">n=[<span class="number">17551188754807399016342420221734945766749930201727412345251590531404061480740932995199065332987719183197199448336435851015540272155441486746027315107821340969105623451575872580170978368650593880274076025520453956378539766228430429142117994616985318963125739076826635459215114946159348678398268099389525414431618517743889314085714390430972783223270985688988995257770363117225472590084489120958397189130958462784532637453482182763505791720641422686749616216521724012108378680177131928438795893866425040489551258902610047574579899692834984999209528110849342042529825594061894238371591910354584305136154355365191215400149</span>,<span class="number">21840437284422601584177601857355845296420300157767339109572377640408362726674561246210400400760474187121246893712480109326893614162779470768415282900713800983815570602250068673695044749932532689851310770087552524620857623442019428044482787965428075984951982104920901562456426672111590909100736209153905853035127247720276974050404663847547090362780729077829594684995979457326414947449083219461617302643392904522733812903141301332227357689517880801845510579518887472928083718826890369016944549160461428710615747001273521253638766267143341819170249648385341127263707417642925464809788975715332938666417316695941347477577</span>,<span class="number">30015914133986758133105015082922460910471726819000479872816812806794140887209294393963063273377891203069864711466776200108173672428779293308320460116493040572826915020654293929241843686728296387400110062099074573009645563520805301899962344680821396200256042478539540675850427377958553324581371362112652752444824919601767821622038488365501031636558236126052654241662743070651213369566898998898634441261811655053789384588711547685939927721116404429914329081432990913321296964957260691148704710581681774562904924080813274984809940008968629515304859518629473284018332651831587916402539386242421630250537030688162675751761</span>,<span class="number">18009718435825445649372629634867772247035138229493108362713630947680338354227735572070882390378632440365163117094233413520107070581908224239210969172094402760924055334584259678276505919418191623762998249724248379302786621689049107500760348303940112840664926231345646325964133281550765454719628161600475143792567309947330130747860125557547051843620899629217636918002929846463097841539446014019579830347356084080488561917440356848465812937246809018168582635191619622041079012450531811237168105634382108634135880887093525611263186925213027913337454706919754923593714509998062073450679720905569489304398625255143801533277</span>,<span class="number">27090736422393991189249636552945539144039087911497773160371557650625344533254580764344628540515132884576739746597729079146155130899009238110101654711303800340566538298798432929136509923129089904647023409146264405964139002638684510681372633714179570768685640570209727600215295330846361754314973731753734397312932947433225732597524076563605729037998272803472953079912899867244318073144564355326520230078681106746670895643454939714423661018216469020021429142336238301775948794784776906058601395026463842070755547793192470653204078222827768950823747061655106900276571547680451953562314376913592896427730473091360051391129</span>,<span class="number">22277916445389799876692954866506052125036892596099795492064670519272419621528759837318253665292779127861537748967309681231938516330289846519214661138299205082421968922350230121526530080908053297879027158545040193774647350499415863211113776785399848472712293535289113810322398103983587423306282629848367328743089145940536913390664697321526306054579656600439140061667264516070003507841618352122567379038304294976725469305215682426898731699093794930417366769249256999177339843020364367769712776225743916112170787273891225926246407201080202593858063362565931942590349178361085396799890148505959437244983447934838792051793</span>,<span class="number">20851005254704933958354817552975190588383962843827122226904964048318053243049822277049715505735762051530592940514007687138882551369906711787133432792478447465241409449145625470766867280545673313710877827491010966285871747638401315338616986782370641881615238434667687936400955629642629748987839996011550408156162317201139746453148874558603034756902297066835592748562014100033050736650359512497633206350878620421058840864178654150287452573363251543090733404389037241843869379543719804499640600546216051812575335078292203435075056740907356476508423562893159958041443951220933694064510275964264723600894558623421819904501</span>,<span class="number">21745680718194037861694569863678082853797244380310200176477643943644972463871360669070584682807703870684830948023158889780219716829353665600564791257912082043905122048004593803193375178269942973208249276102769671038752489438400731535367257356207098737711096953679231300720903502192144476519811856646400822239966219746455729409375771797064825552958482297097797911599808242875799342438899636328763766908154658738969614707377852147843953614178305416594819846812426828300689497046389665982817209315784313108617753052015326937047712513569322963102500122038505770232917473260057408981125469607573191926134043719437868156273</span>,<span class="number">23257483042331781031320004066395973098539881870433034498180628292164825476845647596122889756396987220787263478778647199033523248861079487991256044473644515960559630792146394039814096408486541588067643811077716428015000310006227815563853161604153799667073262886506475792902392829571472354691875108497532721686076971371510238161060553858839091026451266521753830084143245517459861325880906431205328541736948784727909518259034781432825317588016829248046749554245422672923121452470552323438808591118050034108325754535134236727740460190849252647561826203675666601441506024780605194340777802389960180532831878689458096046821</span>,<span class="number">27637004622327338030988157906180324667829916751358977640832765328645718696385482091781513197472066052101704131751158627239657425473994441143385613105528200215275110466263289952962400664293602133856809475295970322767309563273999319926150648399522508592521685688896842833243324070987594588134776515978198364901455727292006058624015674914131447232032058875410956114939938460192876157612457774033922125553271809409381181134668696682847583314698759337802814876161751333701826176655372126746717533228292189928645064111959824895679517476699556313948724818860906006774808944802984477517788391260149504822396276593451707118257</span>]</span><br><span class="line"></span><br><span class="line">c=[<span class="number">4675182605549711347653299514777826238559040200527747810846901991433127025723361807211672208052862870258047285285949212515664278410499603829663266213968511493974766674071825225536665267049044619340378438531615983696406305841945756396579371794826265549929503043134668360055027276522368879193620937457881486509311711905722483187734650127796510808637890189952840971330768913946884525594627652458745930532219238258911608744112001798136394806004726472890838481881026716605743812674350955258003794590748258523929460446986020794445478076559635145181909093786617716473870604463315696183050495143502762614767485881979217577416</span>,<span class="number">4586033930015814975553487614321341290358072960539564849589758593801587823414394351862074093343255479635303199078561905260793645869942622136164615776822867275172888812989071016687658023005838776181437470204528335444413852561895603377955959308318399246963213964044984235974352824060625970587119586612774322385216810264819426458641852166009899106655036755913322283219739741020656812034348404092018340277026844114272699170323014050087289715403989671918767712613414346320222745328800096615947138667139053339483278319521201983885423491905171167675501563556563890821756892474999549635650486944010346554641603343238490572689</span>,<span class="number">12012575342366442210994368605032582129674485327006093552902983877957202172783938071684841031902396156899396879136388606996807608296316795628987877357547213450360953742947781700549506469226564975927361748596520878542651668963131021269851928174681007347771519569914690980744941965086762285630082781013781879511681353119117280354102271439057204066405072328422057721895983540492150402309552609035008272366176657384174081229798739099558539083074489500359062010164358300087124447037922844709870430218019673914305742939927888838599616520300011913022792060392260618046807788302643742874847024153198113792628046678578753632923</span>,<span class="number">4249005911324898630458723491151576810198619078332972911420166645127258598519950448507640904379342817486426262054889199369385257812524759761245588973651578211291344326619317559377360319507727729535083143293335799588196976241949218037833747839545295030259115279668065886560417877204054684495047181117075603468672292268831273735956964067626837975218539840667641885621426607941950306330198897187683754687379611844278471572791816397950634388907233312117920634807989734011132718334334850592111651631323130933438007008983489782601827321396168104668493332626558911838721998173148508994771473224050827471186478106896949413831</span>,<span class="number">18557109853898405974924769550105345673703067457537813607252151469933140760798378574244439559372100428971400070351173140348823652755825601433268832363575896137364288069984314151346137206115518309597389268875150549696376813277778514591532615794294637044626683931367510181612383681914421702261592233265455950023252407680604041046629667703207133146853618989187597749132650514038584280417791134426596848369417626039533740827554552117727501565841065077835398951826747855393552731497438983274201599740189743630949174610722118659019630964669901438690028070213710833335622573526403588737092869273969581607637522572757015237506</span>,<span class="number">19221531342713801219971420455098666365124810169512711030444063942333694562364114172361552139176582476168134219937393468391346535097965763785916484012657401095066804857900941482772687159471483908107669892419626059680168762119954068288719303591498504050604628627299671160225276355636519961578118413913001058744164531470610279168723402009469959377794138715204862239973561494796213624769358906726186769711689962808937828553399403173762034548974335960107700638910231658795639167906700770120741974418495196827830462542130080965552102416180517600397897065113788279096066792533807104187868678848857780735334749865813019681909</span>,<span class="number">2043866718532927301454127017521835945401727173760352488220517028498861777262807036566165189285730569375083406234212921588654098421290088269551352101830688429903600880691046607902396566775005694148315605616437713115424223594710186677844867273218443350479253279231960061845711898262461185970057002138523262952260834191169438764964758526877361442277664448596129451496415695776781879266732057920583336999766633938582656240607973759756021032489262381190762825081392613689817792764844409877116240223852376311404164963595040347176139494461319495285348608562589901671620063620688524249523700500144604558899272202564535295466</span>,<span class="number">9018406452041117867927204674649220929160509942604290572303644183451237944912470236367308266319079349289625873447647200474598755869642999213142758825809522474810817609751187533346902667225032452694187162262683056445775455963994237202296104812386374636270188433521927503415507963477240913270879794141170568393025367891003921090015993944946205723601349149601256727433716155121883420271498265967234259068535172501445643752691860997480636101699340740265505767091920668218018002976632111256430655619061247292025654740889077014179258647084698229733160071306390020603636210736363198302407289195286953980520285032528614492926</span>,<span class="number">17978671919734595201524186618868659656036765546673883938819333911564948587858876495802600244078413312462813938682090761599961604959609423010904187720748539707172853352540370208991902929002036775381503365170196838626379685712050728875172622632447875368166743751159775611642629408534890684109652648484868876710697249351895355111511281037497347712241242908563699707272843032773107477368790419109907271096351457526240471975122296483655337150130000812813081239181653384419149292970320991892073352340649237387406498087734708162094476092368665794350968924289259192893289337038201504066310173284757044802449600666007821509553</span>,<span class="number">8597067880812456123669594978660135058668875834924201279924162761020137582662367704504988576614934966062323191666982943113656186783894245035267051756178331490881264629774635620179678000947771928854566239213498586078670870127924696459041295848474073879336501325437194563845414699360564571136683492426292766799121155041276162673427700999761055592609213603158576637212003771003996722743170543342885011289692845493598413965688949325670519743413071479057382602222055902593614159427186017797992219490308930116850084553033461316509457834436420821916094206010206229370273622681413176347187252950087428868295965528772832409316</span>]</span><br><span class="line"></span><br><span class="line">data=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(c):</span><br><span class="line">	data += [(c[i],n[i])]</span><br><span class="line">x, n = chinese_remainder_theorem(data)</span><br><span class="line">realnum = gmpy.mpz(x).root(e)[<span class="number">0</span>].digits()</span><br><span class="line"><span class="keyword">print</span> my_parse_number(int(realnum))</span><br><span class="line"><span class="comment">#When e are small and same,it can be Hastad's broadcast attack.Maybe we won't have topic aboout RSA,but I wish you can explore it Non-stop.hctf&#123;Hastad's_broadcast_attack_is_interesting&#125;</span></span><br></pre></td></tr></table></figure></p>
<p>得flag：<code>hctf{Hastad&#39;s_broadcast_attack_is_interesting}</code></p>
<h2 id="提供enc和pem文件类"><a href="#提供enc和pem文件类" class="headerlink" title="提供enc和pem文件类"></a>提供enc和pem文件类</h2><p>这类题目需要用linux的openssl来解。</p>
<p>例题：Jarvis OJ Medium RSA</p>
<p>题目：<a href="http://pan.baidu.com/s/1kVwkEmb" target="_blank" rel="noopener">http://pan.baidu.com/s/1kVwkEmb</a> 密码：snl4</p>
<p>题目描述：flag.enc，pubkey.pem</p>
<p>linux下敲命令：<code>openssl rsa -pubin -text -modulus -in warmup -in pubkey.pem</code></p>
<p><img src="http://ordvwjm69.bkt.clouddn.com/crypto_note_26e429e1b846088e78be9866e092a6cc.png" alt=""></p>
<p>得到：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">e=<span class="number">65537</span></span><br><span class="line">n=<span class="number">0xC2636AE5C3D8E43FFB97AB09028F1AAC6C0BF6CD3D70EBCA281BFFE97FBE30DD</span></span><br></pre></td></tr></table></figure></p>
<p>factordb分解n：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">q=<span class="number">275127860351348928173285174381581152299</span></span><br><span class="line">p=<span class="number">319576316814478949870590164193048041239</span></span><br></pre></td></tr></table></figure></p>
<p>模反（方法见前）得d:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">d=<span class="number">10866948760844599168252082612378495977388271279679231539839049698621994994673</span></span><br></pre></td></tr></table></figure></p>
<p>此时不能使用之前的方法解密，是解不出来的，还是需要用openssl，不过在这之前，需要用rsatool.py（在文章最前面，建议ctrl+F搜索）生成私钥。</p>
<p>linux下敲入（先把rsatool.py放在当前目录）：<code>python rsatool.py -o private.pem -e 65537 -p 275127860351348928173285174381581152299 -q 319576316814478949870590164193048041239</code></p>
<p><img src="http://ordvwjm69.bkt.clouddn.com/crypto_note_3c9f2e327f7c112f0b150a042abd3d1a.png" alt=""></p>
<p>得到私钥以后用openssl解密：<code>openssl rsautl -decrypt -in flag.enc -inkey private.pem -out flag.dec</code></p>
<p><img src="http://ordvwjm69.bkt.clouddn.com/crypto_note_d7e8092b0a64fb46291630b009191b40.png" alt=""></p>
<p>flag:<code>PCTF{256b_i5_m3dium}</code></p>
<h2 id="Rabin-密码类"><a href="#Rabin-密码类" class="headerlink" title="Rabin 密码类"></a>Rabin 密码类</h2><p>具体的看wiki吧：<a href="https://en.wikipedia.org/wiki/Rabin_cryptosystem" target="_blank" rel="noopener">https://en.wikipedia.org/wiki/Rabin_cryptosystem</a></p>
<p>这个我也是第一次接触，慢慢啃下来的，应该会写的很唠叨（可能还有错误），也算是自己的笔记吧。</p>
<p>例题：Jarvis OJ Hard RSA</p>
<p>题目：<a href="http://pan.baidu.com/s/1nv4UcI1" target="_blank" rel="noopener">http://pan.baidu.com/s/1nv4UcI1</a> 密码：obbz</p>
<p>题目描述：flag.enc，pubkey.pem。1.不需要爆破。2.用你的数学知识解决此题。3.难道大家都不会开根号吗？</p>
<p>同上，先openssl，得到e和n：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">e=<span class="number">2</span></span><br><span class="line">n=<span class="number">0xC2636AE5C3D8E43FFB97AB09028F1AAC6C0BF6CD3D70EBCA281BFFE97FBE30DD</span></span><br></pre></td></tr></table></figure>
<p>factordb分解n：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">p = <span class="number">275127860351348928173285174381581152299</span></span><br><span class="line">q = <span class="number">319576316814478949870590164193048041239</span></span><br></pre></td></tr></table></figure></p>
<p>我们观察到e为2，提示用数学知识来解，所以应该是Rabin密码。</p>
<p>先写一下Rabin的加密方法：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">p,q</span><br><span class="line">n=p*q</span><br><span class="line">p = &#123;0,1,2 ... n-1&#125;</span><br><span class="line">取m∈p</span><br><span class="line"></span><br><span class="line">c ≡ m^2 (mod n)</span><br></pre></td></tr></table></figure></p>
<p>Rabin解密：</p>
<p>首先因为$c = m^2 \pmod{n}$</p>
<p>从而有$m_p = \sqrt{c} \pmod{p}$ 和 $m_q = \sqrt{c} \pmod{q}$</p>
<p>又因为二次剩余：</p>
<p>若p是奇质数且p不能整除d，则：<br>1.d是模p的二次剩余当且仅当：$d^{\frac{p-1}{2}} \equiv 1 \pmod{p}$<br>2.d是模p的非二次剩余当且仅当：$d^{\frac{p-1}{2}} \equiv -1 \pmod{p}$</p>
<p>两遍同时乘上d，再开根号，得到：$\pm c^{\frac{p+1}{4}} \equiv \sqrt{c} \pmod{n}$</p>
<p>所以$m_p \equiv c^{\frac{p+1}{4}} \pmod p$ ， $m_q \equiv c^{\frac{q+1}{4}} \pmod q$</p>
<p>然后根据中国剩余定理：</p>
<p>设正整数$m_1,m_2…m_k$两两互素，则同余方程组<br>$x \equiv a_1 \pmod{m_1}$<br>$x \equiv a_2 \pmod{m_2}$<br>$x \equiv a_3 \pmod{m_3}$<br>…<br>$x \equiv a_k \pmod{m_k}$</p>
<p>有整数解。并且在模$M = m_1 \cdot m_2 \cdot … \cdot m_k$下的解是唯一的，解为<br>$x \equiv (a_1M_1M_1^{-1} + a_2M_2M_2^{-1} + … + a_kM_kM_k^{-1}) \mod M$</p>
<p>其中$M_i = M / m_i$，而$M_i^{-1}$为$M_i$模$m_i$的逆元。</p>
<p>故我们得到：<br>$r = (y_p \cdot p \cdot m_q + y_q \cdot q \cdot m_p) \mod n$<br>$-r = n - r$<br>$s= (y_p \cdot p \cdot m_q - y_q \cdot q \cdot m_p) \mod n$<br>$-s = n - s$</p>
<p>其中有一个为我们想要的明文m。</p>
<p>python解密：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">n2s</span><span class="params">(num)</span>:</span></span><br><span class="line">	t = hex(num)[<span class="number">2</span>:]</span><br><span class="line">	<span class="keyword">if</span> len(t) % <span class="number">2</span> == <span class="number">1</span>:</span><br><span class="line">		<span class="keyword">return</span> (<span class="string">'0'</span>+t).decode(<span class="string">'hex'</span>)</span><br><span class="line">	<span class="keyword">return</span> t.decode(<span class="string">'hex'</span>)</span><br><span class="line"></span><br><span class="line">c = int(open(<span class="string">'flag.enc'</span>,<span class="string">'rb'</span>).read().encode(<span class="string">'hex'</span>),<span class="number">16</span>)</span><br><span class="line">p = <span class="number">275127860351348928173285174381581152299</span></span><br><span class="line">q = <span class="number">319576316814478949870590164193048041239</span></span><br><span class="line">n = p*q</span><br><span class="line">r = pow(c,(p+<span class="number">1</span>)/<span class="number">4</span>,p)</span><br><span class="line">s = pow(c,(q+<span class="number">1</span>)/<span class="number">4</span>,q)</span><br><span class="line">a = gmpy.invert(p,q)</span><br><span class="line">b = gmpy.invert(q,p)</span><br><span class="line">x =(a*p*s+b*q*r)%n</span><br><span class="line">y =(a*p*s-b*q*r)%n</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> n2s(x%n)</span><br><span class="line"><span class="keyword">print</span> n2s((-x)%n)</span><br><span class="line"><span class="keyword">print</span> n2s(y%n)</span><br><span class="line"><span class="keyword">print</span> n2s((-y)%n)</span><br></pre></td></tr></table></figure></p>
<p>最后在输出中找到flag：<code>PCTF{sp3ci4l_rsa}</code></p>
<h2 id="共模攻击类"><a href="#共模攻击类" class="headerlink" title="共模攻击类"></a>共模攻击类</h2><p>如果在RSA的使用中使用了相同的模n对相同的明文m进行了加密，那么就可以在不分解n的情况下还原出明文m的值。</p>
<p>例题：Jarvis OJ Hard RSA</p>
<p>题目：<a href="http://pan.baidu.com/s/1jIfXHoM" target="_blank" rel="noopener">http://pan.baidu.com/s/1jIfXHoM</a> 密码：9fyr</p>
<p>题目描述：flag.enc1，flag.enc2，veryhardRSA.py</p>
<p>首先分析加密脚本，先判断下是否够512-11位，不够的随机补全。<br>然后就是使用相同的N，不同的e,加密相同的数据。所以想到了共模攻击。</p>
<p>即加密时有：<br>$ c_1\equiv m^{e_1} \pmod{n}$<br>$ c_2\equiv m^{e_2} \pmod{n}$</p>
<p>如果$e_1,e_2$互质，即存在$s_1,s_2$使得：<br>$ s_1e_1+s_2e_2=1 $</p>
<p>从而可以化简得到：$c_1^{s_1}c_2^{s_2}\equiv m$ $mod$ $n$</p>
<p>python脚本：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy <span class="keyword">import</span> invert</span><br><span class="line">n = <span class="number">0x00b0bee5e3e9e5a7e8d00b493355c618fc8c7d7d03b82e409951c182f398dee3104580e7ba70d383ae5311475656e8a964d380cb157f48c951adfa65db0b122ca40e42fa709189b719a4f0d746e2f6069baf11cebd650f14b93c977352fd13b1eea6d6e1da775502abff89d3a8b3615fd0db49b88a976bc20568489284e181f6f11e270891c8ef80017bad238e363039a458470f1749101bc29949d3a4f4038d463938851579c7525a69984f15b5667f34209b70eb261136947fa123e549dfff00601883afd936fe411e006e4e93d1a00b0fea541bbfc8c5186cb6220503a94b2413110d640c77ea54ba3220fc8f4cc6ce77151e29b3e06578c478bd1bebe04589ef9a197f6f806db8b3ecd826cad24f5324ccdec6e8fead2c2150068602c8dcdc59402ccac9424b790048ccdd9327068095efa010b7f196c74ba8c37b128f9e1411751633f78b7b9e56f71f77a1b4daad3fc54b5e7ef935d9a72fb176759765522b4bbc02e314d5c06b64d5054b7b096c601236e6ccf45b5e611c805d335dbab0c35d226cc208d8ce4736ba39a0354426fae006c7fe52d5267dcfb9c3884f51fddfdf4a9794bcfe0e1557113749e6c8ef421dba263aff68739ce00ed80fd0022ef92d3488f76deb62bdef7bea6026f22a1d25aa2a92d124414a8021fe0c174b9803e6bb5fad75e186a946a17280770f1243f4387446ccceb2222a965cc30b3929</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">egcd</span><span class="params">(a, b)</span>:</span></span><br><span class="line">	<span class="keyword">if</span> a == <span class="number">0</span>:</span><br><span class="line">		<span class="keyword">return</span> (b, <span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		g, y, x = egcd(b % a, a)</span><br><span class="line">		<span class="keyword">return</span> (g, x - (b // a) * y, y)</span><br><span class="line"></span><br><span class="line">c1 = int(open(<span class="string">'flag.enc1'</span>, <span class="string">'rb'</span>).read().encode(<span class="string">'hex'</span>),<span class="number">16</span>)</span><br><span class="line">c2 = int(open(<span class="string">'flag.enc2'</span>, <span class="string">'rb'</span>).read().encode(<span class="string">'hex'</span>),<span class="number">16</span>)</span><br><span class="line">e1 = <span class="number">17</span></span><br><span class="line">e2 = <span class="number">65537</span></span><br><span class="line">s = egcd(e1,e2)</span><br><span class="line">s1 = s[<span class="number">1</span>]</span><br><span class="line">s2 = s[<span class="number">2</span>]</span><br><span class="line"><span class="keyword">if</span> s1&lt;<span class="number">0</span>:</span><br><span class="line">	s1 = - s1</span><br><span class="line">	c1 = invert(c1, n)</span><br><span class="line"><span class="keyword">elif</span> s2&lt;<span class="number">0</span>:</span><br><span class="line">	s2 = - s2</span><br><span class="line">	c2 = invert(c2, n)</span><br><span class="line">m = pow(c1, s1, n) * pow(c2, s2, n) % n</span><br><span class="line"><span class="keyword">print</span> hex(m)[<span class="number">2</span>:].decode(<span class="string">'hex'</span>)</span><br></pre></td></tr></table></figure></p>
<p>flag:<code>PCTF{M4st3r_oF_Number_Th3ory}</code></p>
<hr>
<h1 id="数论相关"><a href="#数论相关" class="headerlink" title="数论相关"></a><strong>数论相关</strong></h1><p>不好分类，只能这样写了。</p>
<p>例题：HCTF GAME 进击的 Crypto [4]</p>
<p>题目描述：python文件</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> mpz, invert</span><br><span class="line"></span><br><span class="line">p = <span class="number">190716027447646792844189733681358379327343061199369341384474902557309769682923254674220284045951117393868651638379541511185212421611653965460100979887725583476037189369599999668327299529542494009290049992057157747007152994025186591269943960410319186487203043168774653327128061548663247131284489765017</span></span><br><span class="line">q = <span class="number">930788704028200015275140127068138499329817310955</span></span><br><span class="line">g = <span class="number">220237156062724657086413463831954488565703875839368639153162645824259735475648417436812689270045835305613201869418328189101417845912386944695747737570415063979393239590022180767575736652824918336764694014421673518178065244519367602124516716571334763354973717129155502536345229391073998560517516716958</span></span><br><span class="line">k = <span class="string">'???'</span></span><br><span class="line">x = <span class="string">'???'</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">data_to_int</span><span class="params">(s)</span>:</span></span><br><span class="line">	<span class="keyword">return</span> int(s.encode(<span class="string">'hex'</span>), <span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">SHA1</span><span class="params">(data)</span>:</span></span><br><span class="line">	<span class="keyword">return</span> data_to_int(hashlib.sha1(data).hexdigest())</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span><span class="params">(data, p, q, g, x, k)</span>:</span></span><br><span class="line">	r = pow(g, k, p) % q</span><br><span class="line">	s = (invert(k, q) * (SHA1(data) + x * r)) % q</span><br><span class="line">	<span class="keyword">return</span> (r, s)</span><br><span class="line"></span><br><span class="line">data1 = <span class="string">"guest"</span></span><br><span class="line">data2 = <span class="string">"admin"</span></span><br><span class="line">(r1, s1) = encrypt(data1, p, q, g, x, k)</span><br><span class="line">(r2, s2) = encrypt(data2, p, q, g, x, k)</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> SHA1(data1)</span><br><span class="line"><span class="keyword">print</span> SHA1(data2)</span><br><span class="line"><span class="keyword">print</span> s1</span><br><span class="line"><span class="keyword">print</span> s2</span><br><span class="line"><span class="keyword">print</span> r1</span><br><span class="line"><span class="keyword">print</span> r2</span><br><span class="line"></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">427262976273228083221871998313131945010029561209591706262118913937489577133576413685540380226864</span></span><br><span class="line"><span class="string">835940898148680488372488685713345793755099380413493862399556052721366535745667186387858109315383</span></span><br><span class="line"><span class="string">618159893787048300752592802884467155388759696698</span></span><br><span class="line"><span class="string">659836539307844663175437862395252943516139307036</span></span><br><span class="line"><span class="string">568752653628483014849549142909331362115254788206</span></span><br><span class="line"><span class="string">568752653628483014849549142909331362115254788206</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getflag</span><span class="params">(data)</span>:</span></span><br><span class="line">	<span class="keyword">print</span> <span class="number">1</span></span><br><span class="line">	<span class="keyword">if</span> data == <span class="string">"getflag"</span>:</span><br><span class="line">		(r, s) = encrypt(data, p, q, g, x, k)</span><br><span class="line">		flag = <span class="string">"hctf&#123;"</span> + str(s % r) + <span class="string">"&#125;"</span></span><br><span class="line">		<span class="keyword">print</span> flag</span><br></pre></td></tr></table></figure>
<p>这里我做一个小小的改动，把gmpy2库改成gmpy，我的linux不知怎的就是装不上gmpy2，就拿gmpy将就一下，反正也能做题，如果有大佬知道怎么装请务必告诉我谢谢。</p>
<p>顺便说一下，我查资料的时候看到一种叫DSA的加密算法和他好像，虽然不知道这是不是DSA。</p>
<p>先观察加密函数：<br>$r = ( g^k \mod p) \mod q$<br>$s = (invert(k, q) <em> (SHA1(data) + x </em> r)) \mod q$<br>其中invert函数是求逆元。</p>
<p>题中给了两组加密，说明只用一组来暴力跑肯定是不科学的。如果从r入手肯定是暴力了，所以我从s入手。</p>
<p>两组的s相减可以发现：</p>
<p>$s2 - s1 = (invert(k,q) * (sha2-sha1)) \mod q$</p>
<p>消掉了其中的x<em>r。我们记s = s2 - s1，sha = sha2 - sha1。<br>得到：$s = (y </em> sha) \mod q$<br>其中：$k*y \mod q = 1$<br>因此我们两边乘k，化简得到：$k = (sha ÷s) \mod q$<br>在python中利用gmpy的<code>divm(sha,s,q)</code>解出k。</p>
<p>对原始的s式子两边乘k,除r得到：<br>$\frac{s1 * k}{r} = (\frac{sha1}{r} + x ) \mod q$</p>
<p>从而化简得到：$x = ((\frac{s1 * k}{r} \mod q) -  (\frac{sha1}{r} \mod q)) \mod q$</p>
<p>在python中利用gmpy的<code>(divm(s1*k,r,q) - divm(sha1,r,q)) % q</code>解出k。</p>
<p>以下为完整的python解密代码：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> gmpy <span class="keyword">import</span> mpz, invert,divm</span><br><span class="line"></span><br><span class="line">p = <span class="number">190716027447646792844189733681358379327343061199369341384474902557309769682923254674220284045951117393868651638379541511185212421611653965460100979887725583476037189369599999668327299529542494009290049992057157747007152994025186591269943960410319186487203043168774653327128061548663247131284489765017</span></span><br><span class="line">q = <span class="number">930788704028200015275140127068138499329817310955</span></span><br><span class="line">g = <span class="number">220237156062724657086413463831954488565703875839368639153162645824259735475648417436812689270045835305613201869418328189101417845912386944695747737570415063979393239590022180767575736652824918336764694014421673518178065244519367602124516716571334763354973717129155502536345229391073998560517516716958</span></span><br><span class="line">sha1 = <span class="number">427262976273228083221871998313131945010029561209591706262118913937489577133576413685540380226864</span></span><br><span class="line">sha2 = <span class="number">835940898148680488372488685713345793755099380413493862399556052721366535745667186387858109315383</span></span><br><span class="line">s1 = <span class="number">618159893787048300752592802884467155388759696698</span></span><br><span class="line">s2 = <span class="number">659836539307844663175437862395252943516139307036</span></span><br><span class="line">r = <span class="number">568752653628483014849549142909331362115254788206</span></span><br></pre></td></tr></table></figure></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">s = s2 - s1</span><br><span class="line">sha = sha2 - sha1</span><br><span class="line"></span><br><span class="line">k = divm(sha,s,q)</span><br><span class="line">x = (divm(s1*k,r,q) - divm(sha1,r,q)) % q</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">data_to_int</span><span class="params">(s)</span>:</span></span><br><span class="line">	<span class="keyword">return</span> int(s.encode(<span class="string">'hex'</span>), <span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">SHA1</span><span class="params">(data)</span>:</span></span><br><span class="line">	<span class="keyword">return</span> data_to_int(hashlib.sha1(data).hexdigest())</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span><span class="params">(data, p, q, g, x, k)</span>:</span></span><br><span class="line">	r = pow(g, k, p) % q</span><br><span class="line">	s = (invert(k, q) * (SHA1(data) + x * r)) % q</span><br><span class="line">	<span class="keyword">return</span> (r, s)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getflag</span><span class="params">(data)</span>:</span></span><br><span class="line">	<span class="keyword">print</span> <span class="number">1</span></span><br><span class="line">	<span class="keyword">if</span> data == <span class="string">"getflag"</span>:</span><br><span class="line">		(r, s) = encrypt(data, p, q, g, x, k)</span><br><span class="line">		flag = <span class="string">"hctf&#123;"</span> + str(s % r) + <span class="string">"&#125;"</span></span><br><span class="line">		<span class="keyword">print</span> flag</span><br><span class="line"></span><br><span class="line">getflag(<span class="string">"getflag"</span>)</span><br></pre></td></tr></table></figure>
<p>解得flag：<code>hctf{88169191231439818447681393510021281730269252095}</code></p>
<hr>
<h1 id="CBC"><a href="#CBC" class="headerlink" title="CBC"></a><strong>CBC</strong></h1><h2 id="CBC字节翻转攻击"><a href="#CBC字节翻转攻击" class="headerlink" title="CBC字节翻转攻击"></a>CBC字节翻转攻击</h2><p>原理见：<a href="http://www.tuicool.com/articles/vEVFZz" target="_blank" rel="noopener">http://www.tuicool.com/articles/vEVFZz</a></p>
<p>例题：HCTF GAME explorer的奇怪番外5</p>
<p>题目描述：</p>
<blockquote>
<p>咱们继续做密码学:)<br>这次的内容和块加密算法的块加密模式有关<br>这次我们来试试密码学中对Cipher Block Chaining (CBC)的一种常见攻击手段——CBC字节翻转攻击。<br>这里是服务器端源代码。<br>nc 121.42.25.113 20002</p>
</blockquote>
<p>源码我贴在这里：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/python</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto <span class="keyword">import</span> Random</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">checkPad</span><span class="params">(data)</span>:</span></span><br><span class="line">    num = ord(data[<span class="number">-1</span>])</span><br><span class="line">    <span class="keyword">if</span> num &lt; <span class="number">1</span> <span class="keyword">or</span> num &gt; <span class="number">16</span>:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"decrypt error"</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">"null:null"</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">1</span>,num+<span class="number">1</span>):</span><br><span class="line">        <span class="keyword">if</span> data[-i] != chr(num):</span><br><span class="line">            <span class="keyword">print</span> <span class="string">"decrypt error"</span></span><br><span class="line">            <span class="keyword">return</span> <span class="string">"null:null"</span></span><br><span class="line">    <span class="keyword">return</span> data[:-num]</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">signin</span><span class="params">()</span>:</span></span><br><span class="line">    token = raw_input(<span class="string">"give me you token:"</span>)</span><br><span class="line">    iv = token[:<span class="number">32</span>].decode(<span class="string">'hex'</span>)</span><br><span class="line">    cipherText = token[<span class="number">32</span>:].decode(<span class="string">'hex'</span>)</span><br><span class="line">    aes = AES.new(key,AES.MODE_CBC,iv)</span><br><span class="line">    plainText = aes.decrypt(cipherText)</span><br><span class="line">    t = checkPad(plainText).split(<span class="string">':'</span>)</span><br><span class="line">    <span class="keyword">if</span> len(t) != <span class="number">2</span>:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"you are not admin"</span></span><br><span class="line">        <span class="keyword">return</span> </span><br><span class="line">    name,passwd = t</span><br><span class="line">    <span class="keyword">if</span> name == <span class="string">'admin'</span> <span class="keyword">and</span> passwd == <span class="string">'alvndasjncakslbdvlaksdn'</span>:</span><br><span class="line">        <span class="keyword">print</span> flag</span><br><span class="line">    <span class="keyword">elif</span> name == <span class="string">'null'</span> <span class="keyword">and</span> passwd == <span class="string">'null'</span>:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"you are not admin"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">signup</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">print</span> <span class="string">"sorry singup is close"</span></span><br><span class="line">    </span><br><span class="line">rand = Random.new() <span class="comment">#use crypto safe random</span></span><br><span class="line"><span class="keyword">for</span> name <span class="keyword">in</span> os.listdir(<span class="string">'.'</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="string">'flag'</span> <span class="keyword">in</span> name:</span><br><span class="line">        fp = open(name)</span><br><span class="line">        flag,key = fp.readlines()</span><br><span class="line">        fp.close()</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">flag = flag.strip()</span><br><span class="line">key = key.strip().decode(<span class="string">'hex'</span>)</span><br><span class="line">welcome = <span class="string">'''</span></span><br><span class="line"><span class="string">+++++++++++++++++++++++++++++++++++++++++++++++++++++++</span></span><br><span class="line"><span class="string">         welcome to explorer's strange crypto</span></span><br><span class="line"><span class="string">+++++++++++++++++++++++++++++++++++++++++++++++++++++++</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line">menu = <span class="string">'''</span></span><br><span class="line"><span class="string">what do you want to do?</span></span><br><span class="line"><span class="string">1.sign in </span></span><br><span class="line"><span class="string">2.sing up</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> welcome</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">    <span class="keyword">print</span> menu,</span><br><span class="line">    choose = raw_input(<span class="string">'enter you choose:'</span>)</span><br><span class="line">    <span class="keyword">if</span> choose == <span class="string">'1'</span>:</span><br><span class="line">        signin()</span><br><span class="line">    <span class="keyword">elif</span> choose == <span class="string">'2'</span>:</span><br><span class="line">        signup()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"invalid choose"</span></span><br></pre></td></tr></table></figure></p>
<p>首先，我们sign up，比如我提交的是bdmin，密码和原来一样，是<br>alvndasjncakslbdvlaksdn。得到了token:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dbc290e4acefd383cd4bb93a0ee020e6169513e29fd7e5452f955b945cab77cf3348a76d1ea5cfc9278c8e2ad3539498</span><br></pre></td></tr></table></figure></p>
<p>观察程序源码可知，前面的16位（decode之后）是iv：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">signin</span><span class="params">()</span>:</span></span><br><span class="line">	token = raw_input(<span class="string">"give me you token:"</span>)</span><br><span class="line">	iv = token[:<span class="number">32</span>].decode(<span class="string">'hex'</span>)</span><br><span class="line">	cipherText = token[<span class="number">32</span>:].decode(<span class="string">'hex'</span>)</span><br><span class="line">	aes = AES.new(key,AES.MODE_CBC,iv)</span><br><span class="line">	plainText = aes.decrypt(cipherText)</span><br><span class="line">	name,passwd = checkPad(plainText).split(<span class="string">':'</span>)</span><br><span class="line">	<span class="keyword">if</span> name == <span class="string">'admin'</span> <span class="keyword">and</span> passwd == <span class="string">'alvndasjncakslbdvlaksdn'</span>:</span><br><span class="line">		<span class="keyword">print</span> flag</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		<span class="keyword">print</span> <span class="string">"you are not admin"</span></span><br></pre></td></tr></table></figure></p>
<p>CBC是16位一组进行加密的，因此我们编写代码在改变iv的情况下把bdmin改成admin：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">a=<span class="string">'dbc290e4acefd383cd4bb93a0ee020e6169513e29fd7e5452f955b945cab77cf3348a76d1ea5cfc9278c8e2ad3539498'</span></span><br><span class="line">b=a.decode(<span class="string">'hex'</span>)</span><br><span class="line">b=list(b)</span><br><span class="line">b[<span class="number">0</span>] = chr(ord(b[<span class="number">0</span>]) ^ ord(<span class="string">'b'</span>) ^ ord(<span class="string">'a'</span>))</span><br><span class="line">b = <span class="string">''</span>.join(b)</span><br><span class="line">c=b.encode(<span class="string">'hex'</span>)</span><br><span class="line"><span class="keyword">print</span> c</span><br></pre></td></tr></table></figure>
<p>得到构造的token：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">d8c290e4acefd383cd4bb93a0ee020e6169513e29fd7e5452f955b945cab77cf3348a76d1ea5cfc9278c8e2ad3539498</span><br></pre></td></tr></table></figure></p>
<p>提交得到flag： <code>hctf{cRypT0_ls_1nteRestlng!}</code></p>
<h2 id="padding-oracle-attack"><a href="#padding-oracle-attack" class="headerlink" title="padding oracle attack"></a>padding oracle attack</h2><p>具体原理见：<a href="http://blog.zhaojie.me/2010/10/padding-oracle-attack-in-detail.html" target="_blank" rel="noopener">http://blog.zhaojie.me/2010/10/padding-oracle-attack-in-detail.html</a></p>
<p>例题：HCTF GAME explorer的奇怪番外6</p>
<p>题目描述：</p>
<blockquote>
<p>这次的内容还是和块加密算法的块加密模式有关<br>这次依然是密码学中对Cipher Block Chaining (CBC)的一种著名攻击手段——padding oracle attack。<br>这里是服务器端源代码。这次就没有注册功能啦。<br>nc 121.42.25.113 20003</p>
</blockquote>
<p>代码在此：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/python</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto <span class="keyword">import</span> Random</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">checkPad</span><span class="params">(data)</span>:</span></span><br><span class="line">    num = ord(data[<span class="number">-1</span>])</span><br><span class="line">    <span class="keyword">if</span> num &lt; <span class="number">1</span> <span class="keyword">or</span> num &gt; <span class="number">16</span>:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"decrypt error"</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">"null:null"</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">1</span>,num+<span class="number">1</span>):</span><br><span class="line">        <span class="keyword">if</span> data[-i] != chr(num):</span><br><span class="line">            <span class="keyword">print</span> <span class="string">"decrypt error"</span></span><br><span class="line">            <span class="keyword">return</span> <span class="string">"null:null"</span></span><br><span class="line">    <span class="keyword">return</span> data[:-num]</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">signin</span><span class="params">()</span>:</span></span><br><span class="line">    token = raw_input(<span class="string">"give me you token:"</span>)</span><br><span class="line">    iv = token[:<span class="number">32</span>].decode(<span class="string">'hex'</span>)</span><br><span class="line">    cipherText = token[<span class="number">32</span>:].decode(<span class="string">'hex'</span>)</span><br><span class="line">    aes = AES.new(key,AES.MODE_CBC,iv)</span><br><span class="line">    plainText = aes.decrypt(cipherText)</span><br><span class="line">    t = checkPad(plainText).split(<span class="string">':'</span>)</span><br><span class="line">    <span class="keyword">if</span> len(t) != <span class="number">2</span>:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"you are not admin"</span></span><br><span class="line">        <span class="keyword">return</span> </span><br><span class="line">    name,passwd = t</span><br><span class="line">    <span class="keyword">if</span> name == <span class="string">'admin'</span> <span class="keyword">and</span> passwd == <span class="string">'alvndasjncakslbdvlaksdn'</span>:</span><br><span class="line">        <span class="keyword">print</span> flag</span><br><span class="line">    <span class="keyword">elif</span> name == <span class="string">'null'</span> <span class="keyword">and</span> passwd == <span class="string">'null'</span>:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"you are not admin"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">signup</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">print</span> <span class="string">"sorry singup is close"</span></span><br><span class="line">    </span><br><span class="line">rand = Random.new() <span class="comment">#use crypto safe random</span></span><br><span class="line"><span class="keyword">for</span> name <span class="keyword">in</span> os.listdir(<span class="string">'.'</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="string">'flag'</span> <span class="keyword">in</span> name:</span><br><span class="line">        fp = open(name)</span><br><span class="line">        flag,key = fp.readlines()</span><br><span class="line">        fp.close()</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">flag = flag.strip()</span><br><span class="line">key = key.strip().decode(<span class="string">'hex'</span>)</span><br><span class="line">welcome = <span class="string">'''</span></span><br><span class="line"><span class="string">+++++++++++++++++++++++++++++++++++++++++++++++++++++++</span></span><br><span class="line"><span class="string">         welcome to explorer's strange crypto</span></span><br><span class="line"><span class="string">+++++++++++++++++++++++++++++++++++++++++++++++++++++++</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line">menu = <span class="string">'''</span></span><br><span class="line"><span class="string">what do you want to do?</span></span><br><span class="line"><span class="string">1.sign in </span></span><br><span class="line"><span class="string">2.sing up</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> welcome</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">    <span class="keyword">print</span> menu,</span><br><span class="line">    choose = raw_input(<span class="string">'enter you choose:'</span>)</span><br><span class="line">    <span class="keyword">if</span> choose == <span class="string">'1'</span>:</span><br><span class="line">        signin()</span><br><span class="line">    <span class="keyword">elif</span> choose == <span class="string">'2'</span>:</span><br><span class="line">        signup()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"invalid choose"</span></span><br></pre></td></tr></table></figure></p>
<p>因为网上大多是 Web 应用中的已知密文的攻击，而这道题是已知明文的攻击。不过大同小异。</p>
<p><img src="http://ordvwjm69.bkt.clouddn.com/crypto_note_a5e3b41452ee888931dcc59f4fafa9ba.png" alt=""></p>
<p>如果我们先随便选取一段密文，根据这种攻击的思想跑出相应的 IV，但是问题在于此时的明文不一定是我们想要的。我们知道 AES 解密后的中间值(即上图中的 Intermidiary Value)是不变的，对于同一段密文和 key 来说。假设我们之前跑出来的明文及 IV 分别为 m1、IV1，要求的明文及 IV 为 m2、IV2</p>
<p>$\begin{matrix} m1\ xor\ IV1 = Intermidiary\ Value \ m2\ xor\ IV2 = Intermidiary\ Value \ IV2 = Intermidiary\ Value\ xor\ m2 \end{matrix}$</p>
<p>也就是说我们用跑出来的 Intermidiary Value 和 想要的明文进行异或，就得得到符合要求的 IV，然后我们从最后一组 token 往前跑，因为这样就可以异或得到的 IV 作为前一组的密文</p>
<p>python脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">host = <span class="string">'121.42.25.113'</span></span><br><span class="line">port = <span class="number">20003</span></span><br><span class="line">sk = socket.socket()</span><br><span class="line">sk.connect((host,port))</span><br><span class="line">time.sleep(<span class="number">0.5</span>)</span><br><span class="line">mes = sk.recv(<span class="number">1024</span>)</span><br><span class="line"></span><br><span class="line">msg1 = <span class="string">'admin:alvndasjnc'</span>.encode(<span class="string">'hex'</span>)</span><br><span class="line">msg2 = <span class="string">'akslbdvlaksdn'</span>.encode(<span class="string">'hex'</span>) + <span class="string">'03'</span> * <span class="number">3</span></span><br><span class="line">intermediary = list(<span class="string">'-'</span> * <span class="number">32</span>)</span><br><span class="line">IV = <span class="string">'0'</span> * <span class="number">32</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sendData</span><span class="params">(IV, c)</span>:</span></span><br><span class="line">    IV = <span class="string">''</span>.join(IV)</span><br><span class="line">    sk.sendall(<span class="string">'1\n'</span>)</span><br><span class="line">    sk.recv(<span class="number">1024</span>)</span><br><span class="line">    sk.sendall(IV + c + <span class="string">'\n'</span>)</span><br><span class="line">    time.sleep(<span class="number">0.01</span>)</span><br><span class="line">    mes = sk.recv(<span class="number">1024</span>)</span><br><span class="line">    <span class="keyword">return</span> mes</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">changeIV</span><span class="params">(IV, num)</span>:</span></span><br><span class="line">    tmp = (<span class="number">32</span> - num)/<span class="number">2</span></span><br><span class="line">    nextPad = tmp + <span class="number">1</span></span><br><span class="line">    <span class="keyword">print</span> str(num + <span class="number">1</span>).zfill(<span class="number">2</span>) + <span class="string">'-'</span> + str(num + <span class="number">2</span>).zfill(<span class="number">2</span>) + <span class="string">': '</span>,</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,tmp + <span class="number">1</span>):</span><br><span class="line">        tmp2 = <span class="number">32</span> - <span class="number">2</span> * i</span><br><span class="line">        IV[tmp2:tmp2+<span class="number">2</span>] = hex(int(<span class="string">''</span>.join(IV[tmp2:tmp2+<span class="number">2</span>]),<span class="number">16</span>) ^ tmp ^ nextPad)[<span class="number">2</span>:].zfill(<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">''</span>.join(IV)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">changeMessageIV</span><span class="params">(IV, m)</span>:</span></span><br><span class="line">    num = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">30</span>,<span class="number">-1</span>,<span class="number">-2</span>):</span><br><span class="line">        IV[i:i+<span class="number">2</span>] = hex(int(<span class="string">''</span>.join(IV[i:i+<span class="number">2</span>]),<span class="number">16</span>) ^ <span class="number">17</span> ^ int(<span class="string">''</span>.join(m[i:i+<span class="number">2</span>]),<span class="number">16</span>))[<span class="number">2</span>:].zfill(<span class="number">2</span>)</span><br><span class="line">        num += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">''</span>.join(IV)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(m, c)</span>:</span></span><br><span class="line">    IV = <span class="string">'0'</span> * <span class="number">32</span>   </span><br><span class="line">    num = <span class="number">30</span></span><br><span class="line">    <span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">if</span> num &lt; <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> changeMessageIV(list(IV), list(m))</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">256</span>):</span><br><span class="line">            h = hex(i)[<span class="number">2</span>:].zfill(<span class="number">2</span>)</span><br><span class="line">            IV = list(IV)</span><br><span class="line">            IV[num:num+<span class="number">2</span>] = h</span><br><span class="line">            res = sendData(IV, c)</span><br><span class="line">            <span class="keyword">if</span> <span class="string">'decrypt error'</span> <span class="keyword">not</span> <span class="keyword">in</span> res:</span><br><span class="line">                IV = changeIV(IV, num)</span><br><span class="line">                <span class="keyword">print</span> IV</span><br><span class="line">                num -= <span class="number">2</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    c = <span class="string">'0'</span> * <span class="number">32</span></span><br><span class="line">    token2 = run(msg2,c)</span><br><span class="line">    <span class="keyword">print</span> <span class="string">'The token 2 is '</span> + token2</span><br><span class="line">    c = token2</span><br><span class="line">    token1 = run(msg1,c)</span><br><span class="line">    <span class="keyword">print</span> <span class="string">'The token 1 is '</span> + token1</span><br><span class="line">    <span class="keyword">print</span> sendData(token1,token2 + <span class="string">'0'</span>*<span class="number">32</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
<h2 id="自改的块加密"><a href="#自改的块加密" class="headerlink" title="自改的块加密"></a>自改的块加密</h2><p>考块加密的基本知识以及<a href="https://simple.wikipedia.org/wiki/Feistel_cipher" target="_blank" rel="noopener">Feistel</a>结构。</p>
<p>例题：HCTF GAME explorer的奇怪番外3</p>
<p>题目描述：</p>
<blockquote>
<p>密钥:explorer<br>密文:1fde6a7b2ff15d0abad691215ca5d470<br>交flag的时候记得加上hctf{}</p>
</blockquote>
<p>加密代码（python）：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">xor</span><span class="params">(a,b)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">''</span>.join([chr(ord(i)^ord(j)) <span class="keyword">for</span> i,j <span class="keyword">in</span> zip(a,b)])</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">HASH</span><span class="params">(data)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> sha256(data).digest()[:<span class="number">8</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bes_encrypt</span><span class="params">(subkeys, data)</span>:</span></span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    d1 = data[:<span class="number">8</span>]</span><br><span class="line">    d2 = data[<span class="number">8</span>:]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> subkeys:</span><br><span class="line">       d1 = xor(xor(HASH(d2),i),d1)</span><br><span class="line">       d1,d2 = d2,d1</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> d2 + d1</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">key_schedule</span><span class="params">(key)</span>:</span></span><br><span class="line">    subKeys = []</span><br><span class="line">    subKey = key</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">16</span>):</span><br><span class="line">        subKey = HASH(subKey)</span><br><span class="line">        subKeys.append(subKey)</span><br><span class="line">    <span class="keyword">return</span> subKeys</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bes</span><span class="params">(key,data)</span>:</span></span><br><span class="line">    subKeys = key_schedule(key)</span><br><span class="line">    <span class="keyword">return</span> bes_encrypt(subKeys, data).encode(<span class="string">'hex'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#the result  is "1fde6a7b2ff15d0abad691215ca5d470"</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    <span class="keyword">print</span> bes(<span class="string">'explorer'</span>,<span class="string">'??flag_is_here??'</span>)</span><br></pre></td></tr></table></figure></p>
<p>用python写出解密函数：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: cp936 -*-</span></span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">xor</span><span class="params">(a,b)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">''</span>.join([chr(ord(i)^ord(j)) <span class="keyword">for</span> i,j <span class="keyword">in</span> zip(a,b)])<span class="comment">#简单的异或</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">HASH</span><span class="params">(data)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> sha256(data).digest()[:<span class="number">8</span>]<span class="comment">#取前8位</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bes_encrypt</span><span class="params">(subkeys, data)</span>:</span></span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    d1 = data[:<span class="number">8</span>]</span><br><span class="line">    d2 = data[<span class="number">8</span>:]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> subkeys:</span><br><span class="line">       d1 = xor(xor(HASH(d2),i),d1)</span><br><span class="line">       d1,d2 = d2,d1</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> d2 + d1</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">key_schedule</span><span class="params">(key)</span>:</span></span><br><span class="line">    subKeys = []</span><br><span class="line">    subKey = key</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">16</span>):</span><br><span class="line">        subKey = HASH(subKey)</span><br><span class="line">        subKeys.append(subKey)<span class="comment">#len(subKeys)=16</span></span><br><span class="line">    <span class="keyword">return</span> subKeys</span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bes</span><span class="params">(key,data)</span>:</span></span><br><span class="line">    subKeys = key_schedule(key)</span><br><span class="line">    <span class="keyword">return</span> bes_encrypt(subKeys, data).encode(<span class="string">'hex'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bes_de</span><span class="params">(key,data)</span>:</span></span><br><span class="line">    subKeys = reversed(key_schedule(key))</span><br><span class="line">    <span class="keyword">return</span> bes_decrypt(subKeys, data.decode(<span class="string">'hex'</span>))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bes_decrypt</span><span class="params">(subkeys, data)</span>:</span></span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    d1 = data[<span class="number">8</span>:]</span><br><span class="line">    d2 = data[:<span class="number">8</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> subkeys:</span><br><span class="line">        d1,d2 = d2,d1</span><br><span class="line">        d1 = xor(xor(HASH(d2),i),d1)</span><br><span class="line">    <span class="keyword">return</span> d1+d2</span><br><span class="line"></span><br><span class="line"><span class="comment">#the result  is "rEvers3_tHe_kEy!"</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    <span class="keyword">print</span> bes_de(<span class="string">'explorer'</span>,<span class="string">'1fde6a7b2ff15d0abad691215ca5d470'</span>)</span><br></pre></td></tr></table></figure>
<p>加上<code>flag{}</code>得到最终的flag：<code>flag{rEvers3_tHe_kEy!}</code></p>
<hr>
<h1 id="古典密码"><a href="#古典密码" class="headerlink" title="古典密码"></a><strong>古典密码</strong></h1><p>古典密码编码方法归根结底主要有两种，即置换和代换。</p>
<p>把明文中的字母重新排列，字母本身不变，但其位置改变了，这样编成的密码称为置换密码。最简单的置换密码是把明文中的字母顺序倒过来，然后截成固定长度的字母组作为密文。</p>
<p>代换密码则是将明文中的字符替代成其他字符。</p>
<h2 id="凯撒密码"><a href="#凯撒密码" class="headerlink" title="凯撒密码"></a>凯撒密码</h2><p>凯撒密码是一种代换密码。明文中的所有字母都在字母表上向后（或向前）按照一个固定数目进行偏移后被替换成密文。</p>
<p>如果有数字，则数字进行另外偏移量的偏移（可能与字母相同）。</p>
<p>例题：HCTF GAME 密码学教室入门（二）</p>
<p>题目描述：mlfrj{Hfjxfw_hnumjw_8x_ozxy_ktw_kzs}</p>
<p>你可以用<a href="http://www.wechall.net/applet/JPK_406.jar" target="_blank" rel="noopener">JPK</a>工具来解，也可以用python来解，比如我选择python。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">a=<span class="string">'mlfrj&#123;Hfjxfw_hnumjw_8x_ozxy_ktw_kzs&#125;'</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">27</span>):</span><br><span class="line">	b = []</span><br><span class="line">	<span class="keyword">for</span> c <span class="keyword">in</span> a:</span><br><span class="line">		<span class="keyword">if</span> c.isalpha() :</span><br><span class="line">			c = chr(ord(c)<span class="number">-1</span>)</span><br><span class="line">			<span class="keyword">if</span> c.isalpha() == <span class="number">0</span>:</span><br><span class="line">				c = chr(ord(c)+<span class="number">26</span>)</span><br><span class="line">		b.append(c)</span><br><span class="line">	</span><br><span class="line">	a = <span class="string">''</span>.join(b)</span><br><span class="line">	<span class="keyword">print</span> a</span><br></pre></td></tr></table></figure>
<p>输出为：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">lkeqi&#123;Geiwev_gmtliv_8w_nywx_jsv_jyr&#125;</span><br><span class="line">kjdph&#123;Fdhvdu_flskhu_8v_mxvw_iru_ixq&#125;</span><br><span class="line">jicog&#123;Ecguct_ekrjgt_8u_lwuv_hqt_hwp&#125;</span><br><span class="line">ihbnf&#123;Dbftbs_djqifs_8t_kvtu_gps_gvo&#125;</span><br><span class="line">hgame&#123;Caesar_cipher_8s_just_for_fun&#125;</span><br><span class="line">gfzld&#123;Bzdrzq_bhogdq_8r_itrs_enq_etm&#125;</span><br><span class="line">feykc&#123;Aycqyp_agnfcp_8q_hsqr_dmp_dsl&#125;</span><br><span class="line">edxjb&#123;Zxbpxo_zfmebo_8p_grpq_clo_crk&#125;</span><br><span class="line">dcwia&#123;Ywaown_yeldan_8o_fqop_bkn_bqj&#125;</span><br><span class="line">cbvhz&#123;Xvznvm_xdkczm_8n_epno_ajm_api&#125;</span><br><span class="line">baugy&#123;Wuymul_wcjbyl_8m_domn_zil_zoh&#125;</span><br><span class="line">aztfx&#123;Vtxltk_vbiaxk_8l_cnlm_yhk_yng&#125;</span><br><span class="line">zysew&#123;Uswksj_uahzwj_8k_bmkl_xgj_xmf&#125;</span><br><span class="line">yxrdv&#123;Trvjri_tzgyvi_8j_aljk_wfi_wle&#125;</span><br><span class="line">xwqcu&#123;Squiqh_syfxuh_8i_zkij_veh_vkd&#125;</span><br><span class="line">wvpbt&#123;Rpthpg_rxewtg_8h_yjhi_udg_ujc&#125;</span><br><span class="line">vuoas&#123;Qosgof_qwdvsf_8g_xigh_tcf_tib&#125;</span><br><span class="line">utnzr&#123;Pnrfne_pvcure_8f_whfg_sbe_sha&#125;</span><br><span class="line">tsmyq&#123;Omqemd_oubtqd_8e_vgef_rad_rgz&#125;</span><br><span class="line">srlxp&#123;Nlpdlc_ntaspc_8d_ufde_qzc_qfy&#125;</span><br><span class="line">rqkwo&#123;Mkockb_mszrob_8c_tecd_pyb_pex&#125;</span><br><span class="line">qpjvn&#123;Ljnbja_lryqna_8b_sdbc_oxa_odw&#125;</span><br><span class="line">poium&#123;Kimaiz_kqxpmz_8a_rcab_nwz_ncv&#125;</span><br><span class="line">onhtl&#123;Jhlzhy_jpwoly_8z_qbza_mvy_mbu&#125;</span><br><span class="line">nmgsk&#123;Igkygx_iovnkx_8y_payz_lux_lat&#125;</span><br><span class="line">mlfrj&#123;Hfjxfw_hnumjw_8x_ozxy_ktw_kzs&#125;</span><br><span class="line">lkeqi&#123;Geiwev_gmtliv_8w_nywx_jsv_jyr&#125;</span><br></pre></td></tr></table></figure></p>
<p>得到：<code>hgame{Caesar_cipher_8s_just_for_fun}</code><br>再对数字进行一定的偏移，比如我们观察此时应该是’1s’。</p>
<p>flag：<code>hgame{Caesar_cipher_1s_just_for_fun}</code></p>
<h2 id="埃特巴什码"><a href="#埃特巴什码" class="headerlink" title="埃特巴什码"></a>埃特巴什码</h2><p>也是一种非常简单的以字母倒序排列作为特殊密钥的替换密码。</p>
<p>替换方法如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ABCDEFGHIJKLMNOPQRSTUVWXYZ</span><br><span class="line">↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓</span><br><span class="line">ZYXWVUTSRQPONMLKJIHGFEDCBA</span><br></pre></td></tr></table></figure></p>
<p>例题：暂无</p>
<p>比如有明文<code>m = the quick brown fox jumps over the lazy dog</code><br>密文：<code>c = gsv jfrxp yildm ulc qfnkh levi gsv ozab wlt</code></p>
<p>python脚本：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> string <span class="keyword">import</span> maketrans,translate</span><br><span class="line"></span><br><span class="line">map = maketrans(<span class="string">'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz'</span>,<span class="string">'ZYXWVUTSRQPONMLKJIHGFEDCBAzyxwvutsrqponmlkjihgfedcba'</span>)</span><br><span class="line"></span><br><span class="line">m_or_c = <span class="string">'gsv jfrxp yildm ulc qfnkh levi gsv ozab wlt'</span></span><br><span class="line"><span class="keyword">print</span> m_or_c.translate(map)</span><br><span class="line"><span class="comment">#the quick brown fox jumps over the lazy dog</span></span><br></pre></td></tr></table></figure></p>
<h2 id="rot类（5-13-18-47）"><a href="#rot类（5-13-18-47）" class="headerlink" title="rot类（5,13,18,47）"></a>rot类（5,13,18,47）</h2><p>rot类其实就是特殊的凯撒密码。特殊在它具有可逆性，可以自我解密。加密和解密的函数相同，比如rot13,13是因为有26个字母，一个字母+13再+13以后就是它本身。</p>
<blockquote>
<p>ROT5：只对数字进行编码，用当前数字往前数的第5个数字替换当前数字，例如当前为0，编码后变成5，当前为1，编码后变成6，以此类推顺序循环。</p>
</blockquote>
<blockquote>
<p>ROT13：只对字母进行编码，用当前字母往前数的第13个字母替换当前字母，例如当前为A，编码后变成N，当前为B，编码后变成O，以此类推顺序循环。</p>
</blockquote>
<blockquote>
<p>ROT18：这是一个异类，本来没有，它是将ROT5和ROT13组合在一起，为了好称呼，将其命名为ROT18。</p>
</blockquote>
<blockquote>
<p>ROT47：对数字、字母、常用符号进行编码，按照它们的ASCII值进行位置替换，用当前字符ASCII值往前数的第47位对应字符替换当前字符，例如当前为小写字母Z，编码后变成大写字母K，当前为数字0，编码后变成符号_。用于ROT47编码的字符其ASCII值范围是33－126，具体可参考ASCII编码。</p>
</blockquote>
<p>例题：HCTF 2014 Entry</p>
<p>题目描述：57R9S980RNOS49973S757PQO9S80Q36P 听说丘比龙一口气能吃“13”个甜甜圈呢！</p>
<p>python解rot13：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> string <span class="keyword">import</span> maketrans,translate</span><br><span class="line"></span><br><span class="line">map = maketrans(<span class="string">'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz'</span>,<span class="string">'NOPQRSTUVWXYZABCDEFGHIJKLMnopqrstuvwxyzabcdefghijklm'</span>)</span><br><span class="line"></span><br><span class="line">m_or_c = <span class="string">'57R9S980RNOS49973S757PQO9S80Q36P'</span></span><br><span class="line"><span class="keyword">print</span> m_or_c.translate(map)</span><br></pre></td></tr></table></figure></p>
<p>得到<code>57E9F980EABF49973F757CDB9F80D36C</code></p>
<p>md5解密得<code>Qoobee</code></p>
<h2 id="简单替换密码"><a href="#简单替换密码" class="headerlink" title="简单替换密码"></a>简单替换密码</h2><p>简单换位密码(Simple Substitution Cipher)加密方式是以每个明文字母被与之唯一对应且不同的字母替换的方式实现的。和埃特巴什码的区别在于他的替换码不再是Z→A，而是乱序的，比如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">abcdefghijklmnopqrstuvwxyz</span><br><span class="line">↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓</span><br><span class="line">phqgiumeaylnofdxjkrcvstzwb</span><br></pre></td></tr></table></figure>
<p>解这种密码我们可以用字频分析的方法（当密文足够长时），或者我们可以利用网站：<a href="http://quipqiup.com/" target="_blank" rel="noopener">http://quipqiup.com/</a></p>
<p>例题：暂无</p>
<p>比如我们有密文：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pmpafxaikkitprdsikcplifhwceigixkirradfeirdgkipgigudkcekiigpwrpucikceiginasikwduearrxiiqepcceindgmieinpwdfprduppcedoikiqiasafmfddfipfgmdafmfdteiki</span><br></pre></td></tr></table></figure></p>
<p>扔进quipqiup中，解得明文：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">again pierre was overtaken by the depression he so dreaded for three days after the delivery of his speech at the lodge he lay on a sofa at home receiving no one and going nowhere</span><br></pre></td></tr></table></figure>
<h2 id="希尔密码"><a href="#希尔密码" class="headerlink" title="希尔密码"></a>希尔密码</h2><p>希尔密码(Hill Cipher)是基于线性代数多重代换密码，由Lester S. Hill在1929年发明。每个字母转换成26进制数字：A=0, B=1, C=2…Z=25一串字母当成n维向量，跟一个n×n的矩阵相乘，再将得出的结果 MOD 26。</p>
<table>
<thead>
<tr>
<th>A</th>
<th>B</th>
<th>C</th>
<th>D</th>
<th>E</th>
<th>F</th>
<th>G</th>
<th>H</th>
<th>I</th>
<th>J</th>
<th>K</th>
<th>L</th>
<th>M</th>
<th>N</th>
<th>O</th>
<th>P</th>
<th>Q</th>
<th>R</th>
<th>S</th>
<th>T</th>
<th>U</th>
<th>V</th>
<th>W</th>
<th>X</th>
<th>Y</th>
<th>Z</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>4</td>
<td>5</td>
<td>6</td>
<td>7</td>
<td>8</td>
<td>9</td>
<td>10</td>
<td>11</td>
<td>12</td>
<td>13</td>
<td>14</td>
<td>15</td>
<td>16</td>
<td>17</td>
<td>18</td>
<td>19</td>
<td>20</td>
<td>21</td>
<td>22</td>
<td>23</td>
<td>24</td>
<td>25</td>
</tr>
</tbody>
</table>
<p>举例：我们有明文<code>ACT</code>，明文对应矩阵：</p>
<p>$\begin{pmatrix}0 \\ 2 \\ 19\end{pmatrix}$</p>
<p>我们的加密密钥为：<code>GYBNQKURP</code>，对应加密矩阵：</p>
<p>$\begin{pmatrix}6&amp;24&amp;1\\ 13&amp;16&amp;10\\ 20&amp;17&amp;15\end{pmatrix}$</p>
<p>计算过程：</p>
<p>$\begin{pmatrix}6&amp;24&amp;1\\ 13&amp;16&amp;10\\ 20&amp;17&amp;15\end{pmatrix}\begin{pmatrix}0\\ 2\\ 19\end{pmatrix} = \begin{pmatrix}67\\ 222\\ 319\end{pmatrix} \equiv \begin{pmatrix}15\\ 14\\ 7\end{pmatrix}\pmod{26}$</p>
<p>得到密文：<code>POH</code></p>
<p>解密先求加密矩阵的逆矩阵，即解密矩阵：</p>
<p>$\begin{pmatrix}6&amp;24&amp;1\\ 13&amp;16&amp;10\\ 20&amp;17&amp;15\end{pmatrix}^{-1} \equiv \begin{pmatrix}8&amp;5&amp;10\\ 21&amp;8&amp;21\\ 21&amp;12&amp;8\end{pmatrix} \pmod{26}$</p>
<p>解密计算：</p>
<p>$\begin{pmatrix}8&amp;5&amp;10\\ 21&amp;8&amp;21\\ 21&amp;12&amp;8\end{pmatrix}\begin{pmatrix}15\\ 14\\ 7\end{pmatrix} \equiv \begin{pmatrix}260\\ 574\\ 539\end{pmatrix} \equiv \begin{pmatrix}0\\ 2\\ 19\end{pmatrix} \pmod{26}$</p>
<p>得到明文：<code>ACT</code></p>
<p>例题：HCTF GAME 密码学教室进阶（六）</p>
<p>题目描述：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">c:jchfecncvxogmtgqtqlqamqutqsgnniw</span><br><span class="line">key:5 17 4 15</span><br><span class="line">完成解密以后加上hgame&#123;&#125;作为flag</span><br></pre></td></tr></table></figure></p>
<p>这题…手解嫌累，写代码我也不会写，只能找个在线解密：<a href="http://www.practicalcryptography.com/ciphers/hill-cipher/" target="_blank" rel="noopener">http://www.practicalcryptography.com/ciphers/hill-cipher/</a></p>
<p>总之扔进去就好了…</p>
<p>flag：<code>hgame{haohaoxuexiandainihuiqiuniyuanma}</code></p>
<h2 id="猪圈密码"><a href="#猪圈密码" class="headerlink" title="猪圈密码"></a>猪圈密码</h2><p>是一种简单的替换密码。</p>
<p><img src="http://ordvwjm69.bkt.clouddn.com/crypto_note_f979ce71270ca29da35f4d5f20a755e6.png" alt=""></p>
<p>应该都看得懂，不解释了。</p>
<h2 id="栅栏密码"><a href="#栅栏密码" class="headerlink" title="栅栏密码"></a>栅栏密码</h2><p>栅栏密码(Rail-fence Cipher)就是把要加密的明文分成N个一组，然后把每组的第1个字符组合，每组第2个字符组合…每组的第N(最后一个分组可能不足N个)个字符组合，最后把他们全部连接起来就是密文，这里以2栏栅栏加密为例。</p>
<p>例题：IDF 聪明的小羊</p>
<p>题目描述：</p>
<blockquote>
<p>一只小羊跳过了栅栏，两只小样跳过了栅栏，一坨小羊跳过了栅栏…<br>tn c0afsiwal kes,hwit1r  g,npt  ttessfu}ua u  hmqik e {m,  n huiouosarwCniibecesnren.</p>
</blockquote>
<p>写个py脚本：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt</span><span class="params">(c = None, zu = <span class="number">0</span>, len = <span class="number">0</span> )</span>:</span></span><br><span class="line">    m=<span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(zu):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(len):</span><br><span class="line">            m = m+c[i+zu*j]</span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line"></span><br><span class="line">c=<span class="string">"tn c0afsiwal kes,hwit1r  g,npt  ttessfu&#125;ua u  hmqik e &#123;m,  n huiouosarwCniibecesnren."</span></span><br><span class="line"><span class="keyword">for</span> zu <span class="keyword">in</span> range(<span class="number">1</span>,len(c)):</span><br><span class="line">    <span class="keyword">if</span> len(c)%zu == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">print</span> decrypt(c,zu,len(c)/zu)</span><br></pre></td></tr></table></figure></p>
<p>输出为可能的答案：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">tn c0afsiwal kes,hwit1r  g,npt  ttessfu&#125;ua u  hmqik e &#123;m,  n huiouosarwCniibecesnren.</span><br><span class="line">taastg su km uwbnnfl,1, sah ,hoCer s hrntf me usncecikw ptuuq  iaien0wei te&#125; i&#123;noris.</span><br><span class="line">the anwser is wctf&#123;C01umnar&#125;,if u is a big new,u can help us think more question,tks.</span><br></pre></td></tr></table></figure></p>
<p>得flag：<code>wctf{C01umnar}</code></p>
<h2 id="培根密码"><a href="#培根密码" class="headerlink" title="培根密码"></a>培根密码</h2><p>替换表（这是最常用的一套）：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">a   AAAAA   g     AABBA   n    ABBAA   t     BAABA</span><br><span class="line">b   AAAAB   h     AABBB   o    ABBAB   u-v   BAABB</span><br><span class="line">c   AAABA   i-j   ABAAA   p    ABBBA   w     BABAA</span><br><span class="line">d   AAABB   k     ABAAB   q    ABBBB   x     BABAB</span><br><span class="line">e   AABAA   l     ABABA   r    BAAAA   y     BABBA</span><br><span class="line">f   AABAB   m     ABABB   s    BAAAB   z     BABBB</span><br></pre></td></tr></table></figure></p>
<p>加密者需使用两种不同字体。准备好一篇包含相同AB字数的假信息后，即两种字体分别代表A型和B型。然后假信息中的每个字母按字体来决定其代表“A”还是“B”。</p>
<p>法兰西斯·培根另外准备了一种方法，其将大小写分别看作A与B。</p>
<p>例题：HCTF GAME 我是一个没节操的misc题目</p>
<p>题目描述：flag的其中一段加密后是：<br><code>wOsHiShUIWOZAINAaaAa_zHeShIsHENMEgUI_SHuinENggaOSuwo}</code></p>
<p>按照大写A，小写B，首先得到：<br><code>BABABABAAAAAAAAABBAB_BABABABAAAAABAA_AABBBAABBBAABBB}</code></p>
<p>查表得到：<code>xiao_xie_hhh}</code></p>
<h2 id="维吉尼亚密码"><a href="#维吉尼亚密码" class="headerlink" title="维吉尼亚密码"></a>维吉尼亚密码</h2><p>等我整理。。。</p>
<p>暂时先扔个网址：<a href="http://quipqiup.com/" target="_blank" rel="noopener">http://quipqiup.com/</a></p>
<hr>
<h1 id="代码混淆加密"><a href="#代码混淆加密" class="headerlink" title="代码混淆加密"></a><strong>代码混淆加密</strong></h1><h2 id="aaencode"><a href="#aaencode" class="headerlink" title="aaencode"></a>aaencode</h2><p>aaencode可以将JS代码转换成常用的网络表情，也就是我们说的颜文字js加密。</p>
<p>在线加密：<a href="http://utf-8.jp/public/aaencode.html" target="_blank" rel="noopener">http://utf-8.jp/public/aaencode.html</a></p>
<p>比如我们有代码：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ﾟωﾟﾉ= <span class="regexp">/｀ｍ´）ﾉ ~┻━┻   /</span><span class="comment">/*´∇｀*/</span> [<span class="string">'_'</span>]; o=(ﾟｰﾟ)  =_=<span class="number">3</span>; c=(ﾟΘﾟ) =(ﾟｰﾟ)-(ﾟｰﾟ); (ﾟДﾟ) =(ﾟΘﾟ)= (o^_^o)/ (o^_^o);(ﾟДﾟ)=&#123;ﾟΘﾟ: <span class="string">'_'</span> ,ﾟωﾟﾉ : ((ﾟωﾟﾉ==<span class="number">3</span>) +<span class="string">'_'</span>) [ﾟΘﾟ] ,ﾟｰﾟﾉ :(ﾟωﾟﾉ+ <span class="string">'_'</span>)[o^_^o -(ﾟΘﾟ)] ,ﾟДﾟﾉ:((ﾟｰﾟ==<span class="number">3</span>) +<span class="string">'_'</span>)[ﾟｰﾟ] &#125;; (ﾟДﾟ) [ﾟΘﾟ] =((ﾟωﾟﾉ==<span class="number">3</span>) +<span class="string">'_'</span>) [c^_^o];(ﾟДﾟ) [<span class="string">'c'</span>] = ((ﾟДﾟ)+<span class="string">'_'</span>) [ (ﾟｰﾟ)+(ﾟｰﾟ)-(ﾟΘﾟ) ];(ﾟДﾟ) [<span class="string">'o'</span>] = ((ﾟДﾟ)+<span class="string">'_'</span>) [ﾟΘﾟ];(ﾟoﾟ)=(ﾟДﾟ) [<span class="string">'c'</span>]+(ﾟДﾟ) [<span class="string">'o'</span>]+(ﾟωﾟﾉ +<span class="string">'_'</span>)[ﾟΘﾟ]+ ((ﾟωﾟﾉ==<span class="number">3</span>) +<span class="string">'_'</span>) [ﾟｰﾟ] + ((ﾟДﾟ) +<span class="string">'_'</span>) [(ﾟｰﾟ)+(ﾟｰﾟ)]+ ((ﾟｰﾟ==<span class="number">3</span>) +<span class="string">'_'</span>) [ﾟΘﾟ]+((ﾟｰﾟ==<span class="number">3</span>) +<span class="string">'_'</span>) [(ﾟｰﾟ) - (ﾟΘﾟ)]+(ﾟДﾟ) [<span class="string">'c'</span>]+((ﾟДﾟ)+<span class="string">'_'</span>) [(ﾟｰﾟ)+(ﾟｰﾟ)]+ (ﾟДﾟ) [<span class="string">'o'</span>]+((ﾟｰﾟ==<span class="number">3</span>) +<span class="string">'_'</span>) [ﾟΘﾟ];(ﾟДﾟ) [<span class="string">'_'</span>] =(o^_^o) [ﾟoﾟ] [ﾟoﾟ];(ﾟεﾟ)=((ﾟｰﾟ==<span class="number">3</span>) +<span class="string">'_'</span>) [ﾟΘﾟ]+ (ﾟДﾟ) .ﾟДﾟﾉ+((ﾟДﾟ)+<span class="string">'_'</span>) [(ﾟｰﾟ) + (ﾟｰﾟ)]+((ﾟｰﾟ==<span class="number">3</span>) +<span class="string">'_'</span>) [o^_^o -ﾟΘﾟ]+((ﾟｰﾟ==<span class="number">3</span>) +<span class="string">'_'</span>) [ﾟΘﾟ]+ (ﾟωﾟﾉ +<span class="string">'_'</span>) [ﾟΘﾟ]; (ﾟｰﾟ)+=(ﾟΘﾟ); (ﾟДﾟ)[ﾟεﾟ]=<span class="string">'\\'</span>; (ﾟДﾟ).ﾟΘﾟﾉ=(ﾟДﾟ+ ﾟｰﾟ)[o^_^o -(ﾟΘﾟ)];(oﾟｰﾟo)=(ﾟωﾟﾉ +<span class="string">'_'</span>)[c^_^o];(ﾟДﾟ) [ﾟoﾟ]=<span class="string">'\"'</span>;(ﾟДﾟ) [<span class="string">'_'</span>] ( (ﾟДﾟ) [<span class="string">'_'</span>] (ﾟεﾟ+(ﾟДﾟ)[ﾟoﾟ]+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) +(o^_^o))+ ((o^_^o) +(o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) +(o^_^o))+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ (c^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ ((o^_^o) +(o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ (c^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (o^_^o))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ (c^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (o^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) +(o^_^o))+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ ((o^_^o) +(o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (o^_^o))+ (o^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+((o^_^o) +(o^_^o))+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((o^_^o) +(o^_^o))+ (o^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+((o^_^o) +(o^_^o))+ (o^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (o^_^o))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (o^_^o))+ (o^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) +(o^_^o))+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) +(o^_^o))+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ (c^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ ((o^_^o) +(o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ ((ﾟｰﾟ) + (o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (o^_^o))+ ((ﾟｰﾟ) + (o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟoﾟ]) (ﾟΘﾟ)) (<span class="string">'_'</span>);</span><br></pre></td></tr></table></figure>
<p>解密方法就是在把代码后面的<code>(&#39;_&#39;);</code>去掉，然后在浏览器控制台上跑一下。</p>
<p>得到：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">anonymous</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="keyword">var</span> f = <span class="string">"ctf&#123;233&#125;"</span>;alert(<span class="string">"flag?"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="JSfuck"><a href="#JSfuck" class="headerlink" title="JSfuck"></a>JSfuck</h2><p>和上面类似。</p>
<p>在线加密：<a href="http://www.jsfuck.com/" target="_blank" rel="noopener">http://www.jsfuck.com/</a></p>
<p>解法同上，把最后一个（）去掉。</p>
<h2 id="jother"><a href="#jother" class="headerlink" title="jother"></a>jother</h2><p>和上面类似。</p>
<p>在线加密：<a href="http://tmxk.org/jother/" target="_blank" rel="noopener">http://tmxk.org/jother/</a></p>
<p>解法同上，把最后一个（）去掉。</p>
<h2 id="brainfuck"><a href="#brainfuck" class="headerlink" title="brainfuck"></a>brainfuck</h2><p>Brainfuck是一种极小化的计算机语言，按照”Turing complete（完整图灵机）”思想设计的语言，它的主要设计思路是：用最小的概念实现一种“简单”的语言，BrainF**k 语言只有八种符号，所有的操作都由这八种符号(&gt; &lt; + - . , [ ])的组合来完成。</p>
<p>在线加解密：<a href="https://www.splitbrain.org/services/ook" target="_blank" rel="noopener">https://www.splitbrain.org/services/ook</a></p>
<p>密文：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">+++++ ++++[ -&gt;+++ +++++ +&lt;]&gt;+ +++++ +++++ +++++ ++.&lt;+ +++[- &gt;++++ &lt;]&gt;+.</span><br><span class="line">&lt;+++[ -&gt;--- &lt;]&gt;-- ---.&lt; ++++[ -&gt;+++ +&lt;]&gt;+ ++++. &lt;++++ ++++[ -&gt;--- -----</span><br><span class="line">&lt;]&gt;-- ----- --.+. ..&lt;++ +++++ +[-&gt;+ +++++ ++&lt;]&gt; +++++ +++++ .&lt;</span><br></pre></td></tr></table></figure></p>
<p>不解释，直接扔进去就好了。</p>
<p>明文：<code>ctf{2333}</code></p>
<hr>
<h1 id="编码类"><a href="#编码类" class="headerlink" title="编码类"></a><strong>编码类</strong></h1><h2 id="base-32-64等"><a href="#base-32-64等" class="headerlink" title="base/32/64等"></a>base/32/64等</h2><p>先说base16，其实就是hex，对，你没有看错。</p>
<p>比如有加密：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">774F73486953685549574F5A41494E41616141615F7A48655368497348454E4D456755495F534875696E454E6767614F5375776F7D</span><br></pre></td></tr></table></figure></p>
<p>直接在python里用decode(‘hex’)就能解出明文。</p>
<hr>
<p>base32：</p>
<p>有如下编码映射表：</p>
<table>
<thead>
<tr>
<th style="text-align:center">Value</th>
<th style="text-align:center">Symbol</th>
<th style="text-align:center"></th>
<th style="text-align:center">Value</th>
<th style="text-align:center">Symbol</th>
<th style="text-align:center"></th>
<th style="text-align:center">Value</th>
<th style="text-align:center">Symbol</th>
<th style="text-align:center"></th>
<th style="text-align:center">Value</th>
<th style="text-align:center">Symbol</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">0</td>
<td style="text-align:center">A</td>
<td style="text-align:center"></td>
<td style="text-align:center">9</td>
<td style="text-align:center">J</td>
<td style="text-align:center"></td>
<td style="text-align:center">18</td>
<td style="text-align:center">S</td>
<td style="text-align:center"></td>
<td style="text-align:center">27</td>
<td style="text-align:center">3</td>
</tr>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">B</td>
<td style="text-align:center"></td>
<td style="text-align:center">10</td>
<td style="text-align:center">K</td>
<td style="text-align:center"></td>
<td style="text-align:center">19</td>
<td style="text-align:center">T</td>
<td style="text-align:center"></td>
<td style="text-align:center">28</td>
<td style="text-align:center">4</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">C</td>
<td style="text-align:center"></td>
<td style="text-align:center">11</td>
<td style="text-align:center">L</td>
<td style="text-align:center"></td>
<td style="text-align:center">20</td>
<td style="text-align:center">U</td>
<td style="text-align:center"></td>
<td style="text-align:center">29</td>
<td style="text-align:center">5</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">D</td>
<td style="text-align:center"></td>
<td style="text-align:center">12</td>
<td style="text-align:center">M</td>
<td style="text-align:center"></td>
<td style="text-align:center">21</td>
<td style="text-align:center">V</td>
<td style="text-align:center"></td>
<td style="text-align:center">30</td>
<td style="text-align:center">6</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center">E</td>
<td style="text-align:center"></td>
<td style="text-align:center">13</td>
<td style="text-align:center">N</td>
<td style="text-align:center"></td>
<td style="text-align:center">22</td>
<td style="text-align:center">W</td>
<td style="text-align:center"></td>
<td style="text-align:center">31</td>
<td style="text-align:center">7</td>
</tr>
<tr>
<td style="text-align:center">5</td>
<td style="text-align:center">F</td>
<td style="text-align:center"></td>
<td style="text-align:center">14</td>
<td style="text-align:center">O</td>
<td style="text-align:center"></td>
<td style="text-align:center">23</td>
<td style="text-align:center">X</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">6</td>
<td style="text-align:center">G</td>
<td style="text-align:center"></td>
<td style="text-align:center">15</td>
<td style="text-align:center">P</td>
<td style="text-align:center"></td>
<td style="text-align:center">24</td>
<td style="text-align:center">Y</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">7</td>
<td style="text-align:center">H</td>
<td style="text-align:center"></td>
<td style="text-align:center">16</td>
<td style="text-align:center">Q</td>
<td style="text-align:center"></td>
<td style="text-align:center">25</td>
<td style="text-align:center">Z</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">8</td>
<td style="text-align:center">I</td>
<td style="text-align:center"></td>
<td style="text-align:center">17</td>
<td style="text-align:center">R</td>
<td style="text-align:center"></td>
<td style="text-align:center">26</td>
<td style="text-align:center">2</td>
<td style="text-align:center"></td>
<td style="text-align:center">pad</td>
<td style="text-align:center">=</td>
</tr>
</tbody>
</table>
<p>只用到了A~Z和2~7。</p>
<hr>
<p>base64：</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Symbol</th>
<th>Value</th>
<th>Symbol</th>
<th>Value</th>
<th>Symbol</th>
<th>Value</th>
<th>Symbol</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>A</td>
<td>17</td>
<td>R</td>
<td>34</td>
<td>i</td>
<td>51</td>
<td>z</td>
</tr>
<tr>
<td>1</td>
<td>B</td>
<td>18</td>
<td>S</td>
<td>35</td>
<td>j</td>
<td>52</td>
<td>0</td>
</tr>
<tr>
<td>2</td>
<td>C</td>
<td>19</td>
<td>T</td>
<td>36</td>
<td>k</td>
<td>53</td>
<td>1</td>
</tr>
<tr>
<td>3</td>
<td>D</td>
<td>20</td>
<td>U</td>
<td>37</td>
<td>l</td>
<td>54</td>
<td>2</td>
</tr>
<tr>
<td>4</td>
<td>E</td>
<td>21</td>
<td>V</td>
<td>38</td>
<td>m</td>
<td>55</td>
<td>3</td>
</tr>
<tr>
<td>5</td>
<td>F</td>
<td>22</td>
<td>W</td>
<td>39</td>
<td>n</td>
<td>56</td>
<td>4</td>
</tr>
<tr>
<td>6</td>
<td>G</td>
<td>23</td>
<td>X</td>
<td>40</td>
<td>o</td>
<td>57</td>
<td>5</td>
</tr>
<tr>
<td>7</td>
<td>H</td>
<td>24</td>
<td>Y</td>
<td>41</td>
<td>p</td>
<td>58</td>
<td>6</td>
</tr>
<tr>
<td>8</td>
<td>I</td>
<td>25</td>
<td>Z</td>
<td>42</td>
<td>q</td>
<td>59</td>
<td>7</td>
</tr>
<tr>
<td>9</td>
<td>J</td>
<td>26</td>
<td>a</td>
<td>43</td>
<td>r</td>
<td>60</td>
<td>8</td>
</tr>
<tr>
<td>10</td>
<td>K</td>
<td>27</td>
<td>b</td>
<td>44</td>
<td>s</td>
<td>61</td>
<td>9</td>
</tr>
<tr>
<td>11</td>
<td>L</td>
<td>28</td>
<td>c</td>
<td>45</td>
<td>t</td>
<td>62</td>
<td>+</td>
</tr>
<tr>
<td>12</td>
<td>M</td>
<td>29</td>
<td>d</td>
<td>46</td>
<td>u</td>
<td>63</td>
<td>/</td>
</tr>
<tr>
<td>13</td>
<td>N</td>
<td>30</td>
<td>e</td>
<td>47</td>
<td>v</td>
<td></td>
<td></td>
</tr>
<tr>
<td>14</td>
<td>O</td>
<td>31</td>
<td>f</td>
<td>48</td>
<td>w</td>
<td></td>
<td></td>
</tr>
<tr>
<td>15</td>
<td>P</td>
<td>32</td>
<td>g</td>
<td>49</td>
<td>x</td>
<td></td>
<td></td>
</tr>
<tr>
<td>16</td>
<td>Q</td>
<td>33</td>
<td>h</td>
<td>50</td>
<td>y</td>
<td>pad</td>
<td>=</td>
</tr>
</tbody>
</table>
<p>解base64直接用python的base64模块就行，不会的用在线解密也可以，玩re的需要去看看base64的加密函数怎么写，逆向时可能会遇到。</p>
<h2 id="莫尔斯电码"><a href="#莫尔斯电码" class="headerlink" title="莫尔斯电码"></a>莫尔斯电码</h2><p>对应表：</p>
<table>
<thead>
<tr>
<th style="text-align:left">字符</th>
<th style="text-align:left">电码</th>
<th style="text-align:left">字符</th>
<th style="text-align:left">电码</th>
<th style="text-align:left">字符</th>
<th style="text-align:left">电码</th>
<th style="text-align:left">字符</th>
<th style="text-align:left">电码</th>
<th style="text-align:left">字符</th>
<th style="text-align:left">电码</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">A</td>
<td style="text-align:left">.-</td>
<td style="text-align:left">N</td>
<td style="text-align:left">-.</td>
<td style="text-align:left">.</td>
<td style="text-align:left">.-.-.-</td>
<td style="text-align:left">+</td>
<td style="text-align:left">.-.-.</td>
<td style="text-align:left">1</td>
<td style="text-align:left">.- - - -</td>
</tr>
<tr>
<td style="text-align:left">B</td>
<td style="text-align:left">-…</td>
<td style="text-align:left">O</td>
<td style="text-align:left">- - -</td>
<td style="text-align:left">,</td>
<td style="text-align:left">- -..- -</td>
<td style="text-align:left">_</td>
<td style="text-align:left">..- -.-</td>
<td style="text-align:left">2</td>
<td style="text-align:left">..- - -</td>
</tr>
<tr>
<td style="text-align:left">C</td>
<td style="text-align:left">-.-.</td>
<td style="text-align:left">P</td>
<td style="text-align:left">.- -.</td>
<td style="text-align:left">:</td>
<td style="text-align:left">- - -…</td>
<td style="text-align:left">$</td>
<td style="text-align:left">…-..-</td>
<td style="text-align:left">3</td>
<td style="text-align:left">…- -</td>
</tr>
<tr>
<td style="text-align:left">D</td>
<td style="text-align:left">-..</td>
<td style="text-align:left">Q</td>
<td style="text-align:left">- -.-</td>
<td style="text-align:left">“</td>
<td style="text-align:left">.-..-.</td>
<td style="text-align:left">&amp;</td>
<td style="text-align:left">.-…</td>
<td style="text-align:left">4</td>
<td style="text-align:left">….-</td>
</tr>
<tr>
<td style="text-align:left">E</td>
<td style="text-align:left">.</td>
<td style="text-align:left">R</td>
<td style="text-align:left">.-.</td>
<td style="text-align:left">‘</td>
<td style="text-align:left">.- - - -.</td>
<td style="text-align:left">/</td>
<td style="text-align:left">-..-.</td>
<td style="text-align:left">5</td>
<td style="text-align:left">…..</td>
</tr>
<tr>
<td style="text-align:left">F</td>
<td style="text-align:left">..-.</td>
<td style="text-align:left">S</td>
<td style="text-align:left">…</td>
<td style="text-align:left">!</td>
<td style="text-align:left">-.-.- -</td>
<td style="text-align:left"></td>
<td style="text-align:left"></td>
<td style="text-align:left">6</td>
<td style="text-align:left">-….</td>
</tr>
<tr>
<td style="text-align:left">G</td>
<td style="text-align:left">- -.</td>
<td style="text-align:left">T</td>
<td style="text-align:left">-</td>
<td style="text-align:left">?</td>
<td style="text-align:left">..- -..</td>
<td style="text-align:left"></td>
<td style="text-align:left"></td>
<td style="text-align:left">7</td>
<td style="text-align:left">- -…</td>
</tr>
<tr>
<td style="text-align:left">H</td>
<td style="text-align:left">….</td>
<td style="text-align:left">U</td>
<td style="text-align:left">..-</td>
<td style="text-align:left">@</td>
<td style="text-align:left">.- -.-.</td>
<td style="text-align:left"></td>
<td style="text-align:left"></td>
<td style="text-align:left">8</td>
<td style="text-align:left">- - -..</td>
</tr>
<tr>
<td style="text-align:left">I</td>
<td style="text-align:left">..</td>
<td style="text-align:left">V</td>
<td style="text-align:left">…-</td>
<td style="text-align:left">-</td>
<td style="text-align:left">-….-</td>
<td style="text-align:left"></td>
<td style="text-align:left"></td>
<td style="text-align:left">9</td>
<td style="text-align:left">- - - -.</td>
</tr>
<tr>
<td style="text-align:left">J</td>
<td style="text-align:left">.- - -</td>
<td style="text-align:left">W</td>
<td style="text-align:left">.- -</td>
<td style="text-align:left">;</td>
<td style="text-align:left">-.-.-.</td>
<td style="text-align:left"></td>
<td style="text-align:left"></td>
<td style="text-align:left">0</td>
<td style="text-align:left">- - - - -</td>
</tr>
<tr>
<td style="text-align:left">K</td>
<td style="text-align:left">-.-</td>
<td style="text-align:left">X</td>
<td style="text-align:left">-..-</td>
<td style="text-align:left">(</td>
<td style="text-align:left">-.- -.</td>
<td style="text-align:left"></td>
<td style="text-align:left"></td>
<td style="text-align:left"></td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left">L</td>
<td style="text-align:left">.-..</td>
<td style="text-align:left">Y</td>
<td style="text-align:left">-.- -</td>
<td style="text-align:left">)</td>
<td style="text-align:left">-.- -.-</td>
<td style="text-align:left"></td>
<td style="text-align:left"></td>
<td style="text-align:left"></td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left">M</td>
<td style="text-align:left">- -</td>
<td style="text-align:left">Z</td>
<td style="text-align:left">- -..</td>
<td style="text-align:left">=</td>
<td style="text-align:left">-…-</td>
<td style="text-align:left"></td>
<td style="text-align:left"></td>
<td style="text-align:left"></td>
<td style="text-align:left"></td>
</tr>
</tbody>
</table>
<p>直接查表就好。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># split by space</span></span><br><span class="line">dic = &#123;<span class="string">'.-'</span>:<span class="string">'A'</span>,<span class="string">'-...'</span>:<span class="string">'B'</span>,<span class="string">'-.-.'</span>:<span class="string">'C'</span>,<span class="string">'-..'</span>:<span class="string">'D'</span>,<span class="string">'.'</span>:<span class="string">'E'</span>,<span class="string">'..-.'</span>:<span class="string">'F'</span>,<span class="string">'--.'</span>:<span class="string">'G'</span>,<span class="string">'....'</span>:<span class="string">'H'</span>,<span class="string">'..'</span>:<span class="string">'I'</span>,<span class="string">'.---'</span>:<span class="string">'J'</span>,<span class="string">'-.-'</span>:<span class="string">'K'</span>,<span class="string">'.-..'</span>:<span class="string">'L'</span>,<span class="string">'--'</span>:<span class="string">'M'</span>,<span class="string">'-.'</span>:<span class="string">'N'</span>,<span class="string">'---'</span>:<span class="string">'O'</span>,<span class="string">'.--.'</span>:<span class="string">'P'</span>,<span class="string">'--.-'</span>:<span class="string">'Q'</span>,<span class="string">'.-.'</span>:<span class="string">'R'</span>,<span class="string">'...'</span>:<span class="string">'S'</span>,<span class="string">'-'</span>:<span class="string">'T'</span>,<span class="string">'..-'</span>:<span class="string">'U'</span>,<span class="string">'...-'</span>:<span class="string">'V'</span>,<span class="string">'.--'</span>:<span class="string">'W'</span>,<span class="string">'-..-'</span>:<span class="string">'X'</span>,<span class="string">'-.--'</span>:<span class="string">'Y'</span>,<span class="string">'--..'</span>:<span class="string">'Z'</span>,<span class="string">'.-.-.-'</span>:<span class="string">'.'</span>,<span class="string">'--..--'</span>:<span class="string">','</span>,<span class="string">'---...'</span>:<span class="string">':'</span>,<span class="string">'.-..-.'</span>:<span class="string">'"'</span>,<span class="string">'.----.'</span>:<span class="string">'\''</span>,<span class="string">'-.-.--'</span>:<span class="string">'!'</span>,<span class="string">'..--..'</span>:<span class="string">'?'</span>,<span class="string">'.--.-.'</span>:<span class="string">'@'</span>,<span class="string">'-....-'</span>:<span class="string">'-'</span>,<span class="string">'-.-.-.'</span>:<span class="string">';'</span>,<span class="string">'.-.-.'</span>:<span class="string">'+'</span>,<span class="string">'..--.-'</span>:<span class="string">'_'</span>,<span class="string">'...-..-'</span>:<span class="string">'$'</span>,<span class="string">'-..-.'</span>:<span class="string">'/'</span>,<span class="string">'.----'</span>:<span class="string">'1'</span>,<span class="string">'..---'</span>:<span class="string">'2'</span>,<span class="string">'...--'</span>:<span class="string">'3'</span>,<span class="string">'....-'</span>:<span class="string">'4'</span>,<span class="string">'.....'</span>:<span class="string">'5'</span>,<span class="string">'-....'</span>:<span class="string">'6'</span>,<span class="string">'--...'</span>:<span class="string">'7'</span>,<span class="string">'---..'</span>:<span class="string">'8'</span>,<span class="string">'----.'</span>:<span class="string">'9'</span>,<span class="string">'-----'</span>:<span class="string">'0'</span>&#125;</span><br><span class="line"></span><br><span class="line">enc=<span class="string">'.--- -... .-.. ..- .-- . .-- -. --..'</span>.split(<span class="string">' '</span>)</span><br><span class="line">dec=<span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> enc:</span><br><span class="line">	dec+=dic[c]</span><br><span class="line"><span class="keyword">print</span> dec</span><br></pre></td></tr></table></figure>
<h2 id="一次性密码本（OTP）"><a href="#一次性密码本（OTP）" class="headerlink" title="一次性密码本（OTP）"></a>一次性密码本（OTP）</h2><p>例题：HCTF GAME 进击的 Crypto [1] - 神秘的加密系统</p>
<p>题目描述：<a href="http://119.29.138.57:23333/crypto/encode_system/" target="_blank" rel="noopener">http://119.29.138.57:23333/crypto/encode_system/</a>（题目源地址，看运气还能不能打开）</p>
<p>我们随便输入，发现每次加密的结果都不一样，猜测加密的key不可能无限长，所以输入了非常长的一串‘1’，试出来key的长度为128bytes。然后观察加密后网页的源码，可以发现下面有flag_enc：</p>
<p><img src="http://ordvwjm69.bkt.clouddn.com/crypto_note_a814f664d8bc605fe2a1a8b2f29e5570.png" alt=""></p>
<p>加密的方法是K xor M_input = C_input ，K xor Flag = Flag_enc。<br>而我们现在知道了M_input，C_input，Flag_enc。</p>
<p>所以Flag = K xor Flag_enc = (M_input xor  C_input)  xor  Flag_enc。</p>
<p>先写个python脚本获取Flag_enc(此处吐槽一下为什么Flag_enc不base64或hex显示)：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> urllib2</span><br><span class="line">req = urllib2.Request( url = <span class="string">'http://119.29.138.57:23333/crypto/encode_system/index.php'</span>, data = <span class="string">'message=11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111'</span>)</span><br><span class="line">response = urllib2.urlopen(req).read()</span><br><span class="line"><span class="keyword">print</span> response</span><br><span class="line"><span class="keyword">print</span> response[<span class="number">-131</span>:<span class="number">-3</span>].encode(<span class="string">'hex'</span>)</span><br></pre></td></tr></table></figure></p>
<p>从而得到了C_input和Flag_enc，python解密之:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">c=[<span class="number">0x59</span>,<span class="number">0x4f</span>,<span class="number">0x72</span>,<span class="number">0x5d</span>,<span class="number">0x5c</span>,<span class="number">0x07</span>,<span class="number">0x72</span>,<span class="number">0x6a</span>,<span class="number">0x7e</span>,<span class="number">0x50</span>,<span class="number">0x07</span>,<span class="number">0x67</span>,<span class="number">0x49</span>,<span class="number">0x44</span>,<span class="number">0x15</span>,<span class="number">0x6a</span>,<span class="number">0x6f</span>,<span class="number">0x7b</span>,<span class="number">0x73</span>,<span class="number">0x5e</span>,<span class="number">0x77</span>,<span class="number">0x18</span>,<span class="number">0x50</span>,<span class="number">0x53</span>,<span class="number">0x59</span>,<span class="number">0x08</span>,<span class="number">0x6c</span>,<span class="number">0x4f</span>,<span class="number">0x40</span>,<span class="number">0x4b</span>,<span class="number">0x74</span>,<span class="number">0x10</span>,<span class="number">0x5d</span>,<span class="number">0x5b</span>,<span class="number">0x59</span>,<span class="number">0x6f</span>,<span class="number">0x15</span>,<span class="number">0x05</span>,<span class="number">0x01</span>,<span class="number">0x62</span>,<span class="number">0x1d</span>,<span class="number">0x6d</span>,<span class="number">0x7d</span>,<span class="number">0x40</span>,<span class="number">0x4c</span>,<span class="number">0x62</span>,<span class="number">0x7d</span>,<span class="number">0x19</span>,<span class="number">0x10</span>,<span class="number">0x04</span>,<span class="number">0x09</span>,<span class="number">0x1b</span>,<span class="number">0x68</span>,<span class="number">0x5f</span>,<span class="number">0x79</span>,<span class="number">0x4d</span>,<span class="number">0x19</span>,<span class="number">0x7e</span>,<span class="number">0x1c</span>,<span class="number">0x4a</span>,<span class="number">0x06</span>,<span class="number">0x09</span>,<span class="number">0x6e</span>,<span class="number">0x55</span>,<span class="number">0x51</span>,<span class="number">0x08</span>,<span class="number">0x12</span>,<span class="number">0x1e</span>,<span class="number">0x70</span>,<span class="number">0x72</span>,<span class="number">0x75</span>,<span class="number">0x6d</span>,<span class="number">0x72</span>,<span class="number">0x70</span>,<span class="number">0x40</span>,<span class="number">0x6c</span>,<span class="number">0x7d</span>,<span class="number">0x04</span>,<span class="number">0x42</span>,<span class="number">0x5d</span>,<span class="number">0x48</span>,<span class="number">0x7f</span>,<span class="number">0x07</span>,<span class="number">0x1e</span>,<span class="number">0x76</span>,<span class="number">0x01</span>,<span class="number">0x42</span>,<span class="number">0x61</span>,<span class="number">0x7a</span>,<span class="number">0x67</span>,<span class="number">0x43</span>,<span class="number">0x00</span>,<span class="number">0x74</span>,<span class="number">0x7d</span>,<span class="number">0x79</span>,<span class="number">0x45</span>,<span class="number">0x41</span>,<span class="number">0x0d</span>,<span class="number">0x55</span>,<span class="number">0x58</span>,<span class="number">0x7a</span>,<span class="number">0x79</span>,<span class="number">0x00</span>,<span class="number">0x4a</span>,<span class="number">0x07</span>,<span class="number">0x52</span>,<span class="number">0x76</span>,<span class="number">0x45</span>,<span class="number">0x04</span>,<span class="number">0x15</span>,<span class="number">0x45</span>,<span class="number">0x44</span>,<span class="number">0x15</span>,<span class="number">0x4d</span>,<span class="number">0x42</span>,<span class="number">0x4b</span>,<span class="number">0x42</span>,<span class="number">0x42</span>,<span class="number">0x5f</span>,<span class="number">0x5d</span>,<span class="number">0x69</span>,<span class="number">0x63</span>,<span class="number">0x5f</span>,<span class="number">0x12</span>,<span class="number">0x74</span>,<span class="number">0x64</span>,<span class="number">0x61</span>,<span class="number">0x7b</span>]</span><br><span class="line"></span><br><span class="line">c_flag=list(<span class="string">'3d11342d4c7230012d036e0c0523071a6a7e1e0b2f4d233d0166242f20286f1e47533903080459794965655529003909107b5f77154622146432744d66430e2e56715f5e043565682d004e6f2a760e3b4a1600476e4b18200f035d7a693d6417286f2d560720520f5018151d434141017b3f420a1b161c336c0d5f501a302a37'</span>.decode(<span class="string">'hex'</span>))</span><br><span class="line"></span><br><span class="line">b=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">128</span>):</span><br><span class="line">	c[i]=c[i]^ord(<span class="string">'1'</span>)</span><br><span class="line">	b.append(chr(c[i] ^ ord(c_flag[i])))</span><br><span class="line">b=<span class="string">''</span>.join(b)</span><br><span class="line"><span class="keyword">print</span> b</span><br><span class="line"><span class="comment">#result：UowA!DsZbbXZ&#125;V#A44\didB_i_yQQR*?+9Q],0i*e9)$TSu!1Ng]L(jhL&#125;Y6Q&#123;QJ6H|qEv!4nA?2fC&#125;W3X6h)&#123;kpDU/K,q,cXSI?Lhctf&#123;Rive5t_C1pher_4_1s_ez&#125;</span></span><br></pre></td></tr></table></figure></p>
<p>得到flag:<code>hctf{Rive5t_C1pher_4_1s_ez}</code></p>

      
    </div>

    

    
    
    

    

    

    
      <div>
        <ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>Post author:  </strong>Veritas501</li>
  <li class="post-copyright-link">
    <strong>Post link: </strong>
    <a href="https://veritas501.github.io/2017/03/01/密码学笔记/" title="密码学笔记">https://veritas501.github.io/2017/03/01/密码学笔记/</a>
  </li>
  <li class="post-copyright-license">
    <strong>Copyright Notice:  </strong>All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow" target="_blank">CC BY-NC-SA 4.0</a> unless stating additionally.</li>
</ul>

      </div>
    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/CTF/" rel="tag"># CTF</a>
          
            <a href="/tags/CRYPTO/" rel="tag"># CRYPTO</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/03/01/HCTF GAME RE - Windows礼包/" rel="next" title="HCTF GAME RE - Windows礼包">
                <i class="fa fa-chevron-left"></i> HCTF GAME RE - Windows礼包
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/03/01/HCTF GAME RE - 零碎的逆向/" rel="prev" title="HCTF GAME RE - 零碎的逆向">
                HCTF GAME RE - 零碎的逆向 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          

  
    <div class="comments" id="comments">
    </div>
  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/215.png"
                alt="Veritas501" />
            
              <p class="site-author-name" itemprop="name">Veritas501</p>
              <p class="site-description motion-element" itemprop="description">开始踏上Re&Pwn之路...</p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">63</span>
                    <span class="site-state-item-name">posts</span>
                  </a>
                </div>
              

              

              
                
                
                <div class="site-state-item site-state-tags">
                  <a href="/tags/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">38</span>
                    <span class="site-state-item-name">tags</span>
                  </a>
                </div>
              
            </nav>
          

          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  <a href="https://github.com/veritas501" target="_blank" title="GitHub"><i class="fa fa-fw fa-github"></i>GitHub</a>
                  
                </span>
              
                <span class="links-of-author-item">
                  <a href="http://music.163.com/#/user/home?id=58295006" target="_blank" title="网易云"><i class="fa fa-fw fa-music"></i>网易云</a>
                  
                </span>
              
                <span class="links-of-author-item">
                  <a href="https://www.zhihu.com/people/xu-qt/activities" target="_blank" title="知乎"><i class="fa fa-fw fa-quora"></i>知乎</a>
                  
                </span>
              
                <span class="links-of-author-item">
                  <a href="https://osu.ppy.sh/users/9533614" target="_blank" title="OSU"><i class="fa fa-fw fa-headphones"></i>OSU</a>
                  
                </span>
              
            </div>
          

          
          

          
          

          
            
          
          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#RSA"><span class="nav-number">1.</span> <span class="nav-text">RSA</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#啥都知道类"><span class="nav-number">1.1.</span> <span class="nav-text">啥都知道类</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#吓唬人类"><span class="nav-number">1.2.</span> <span class="nav-text">吓唬人类</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#n能被工具快速分解类"><span class="nav-number">1.3.</span> <span class="nav-text">n能被工具快速分解类</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#多个n有公约数分解类"><span class="nav-number">1.4.</span> <span class="nav-text">多个n有公约数分解类</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#低加密指数广播攻击类"><span class="nav-number">1.5.</span> <span class="nav-text">低加密指数广播攻击类</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#提供enc和pem文件类"><span class="nav-number">1.6.</span> <span class="nav-text">提供enc和pem文件类</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Rabin-密码类"><span class="nav-number">1.7.</span> <span class="nav-text">Rabin 密码类</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#共模攻击类"><span class="nav-number">1.8.</span> <span class="nav-text">共模攻击类</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#数论相关"><span class="nav-number">2.</span> <span class="nav-text">数论相关</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#CBC"><span class="nav-number">3.</span> <span class="nav-text">CBC</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#CBC字节翻转攻击"><span class="nav-number">3.1.</span> <span class="nav-text">CBC字节翻转攻击</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#padding-oracle-attack"><span class="nav-number">3.2.</span> <span class="nav-text">padding oracle attack</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#自改的块加密"><span class="nav-number">3.3.</span> <span class="nav-text">自改的块加密</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#古典密码"><span class="nav-number">4.</span> <span class="nav-text">古典密码</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#凯撒密码"><span class="nav-number">4.1.</span> <span class="nav-text">凯撒密码</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#埃特巴什码"><span class="nav-number">4.2.</span> <span class="nav-text">埃特巴什码</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#rot类（5-13-18-47）"><span class="nav-number">4.3.</span> <span class="nav-text">rot类（5,13,18,47）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#简单替换密码"><span class="nav-number">4.4.</span> <span class="nav-text">简单替换密码</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#希尔密码"><span class="nav-number">4.5.</span> <span class="nav-text">希尔密码</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#猪圈密码"><span class="nav-number">4.6.</span> <span class="nav-text">猪圈密码</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#栅栏密码"><span class="nav-number">4.7.</span> <span class="nav-text">栅栏密码</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#培根密码"><span class="nav-number">4.8.</span> <span class="nav-text">培根密码</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#维吉尼亚密码"><span class="nav-number">4.9.</span> <span class="nav-text">维吉尼亚密码</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#代码混淆加密"><span class="nav-number">5.</span> <span class="nav-text">代码混淆加密</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#aaencode"><span class="nav-number">5.1.</span> <span class="nav-text">aaencode</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#JSfuck"><span class="nav-number">5.2.</span> <span class="nav-text">JSfuck</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#jother"><span class="nav-number">5.3.</span> <span class="nav-text">jother</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#brainfuck"><span class="nav-number">5.4.</span> <span class="nav-text">brainfuck</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#编码类"><span class="nav-number">6.</span> <span class="nav-text">编码类</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#base-32-64等"><span class="nav-number">6.1.</span> <span class="nav-text">base/32/64等</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#莫尔斯电码"><span class="nav-number">6.2.</span> <span class="nav-text">莫尔斯电码</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#一次性密码本（OTP）"><span class="nav-number">6.3.</span> <span class="nav-text">一次性密码本（OTP）</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      
        <div class="back-to-top">
          <i class="fa fa-arrow-up"></i>
          
            <span id="scrollpercent"><span>0</span>%</span>
          
        </div>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2017 &mdash; <span itemprop="copyrightYear">2018</span>
  <span class="with-love" id="animate">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Veritas501</span>

  

  
</div>




  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> v3.7.1</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://theme-next.org">NexT.Gemini</a> v6.3.0</div>




        








        
      </div>
    </footer>

    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.3.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.3.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=6.3.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=6.3.0"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=6.3.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=6.3.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.3.0"></script>



  



  





  








  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  
  
  <script src="//unpkg.com/valine/dist/Valine.min.js"></script>
  
  <script type="text/javascript">
    var GUEST = ['nick','mail','link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(function (item) {
      return GUEST.indexOf(item)>-1;
    });
    new Valine({
        el: '#comments' ,
        verify: false,
        notify: false,
        appId: 'zUGXRoho5JEFbk0lDKssrDi6-gzGzoHsz',
        appKey: 'IE9Knp7ku8I57kP5vFnPO2zA',
        placeholder: '说点什么...',
        avatar:'mm',
        guest_info:guest,
        pageSize:'10' || 10,
    });
  </script>



  





  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script>
  <script>AV.initialize("97qzbH6lJuabRg1KDY7DtJRS-gzGzoHsz", "GS8vVhMCaeXncQF8mQOIShBj");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            
            counter.save(null, {
              success: function(counter) {
                
                  var $element = $(document.getElementById(url));
                  $element.find('.leancloud-visitors-count').text(counter.get('time'));
                
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            
              var newcounter = new Counter();
              /* Set ACL */
              var acl = new AV.ACL();
              acl.setPublicReadAccess(true);
              acl.setPublicWriteAccess(true);
              newcounter.setACL(acl);
              /* End Set ACL */
              newcounter.set("title", title);
              newcounter.set("url", url);
              newcounter.set("time", 1);
              newcounter.save(null, {
                success: function(newcounter) {
                  var $element = $(document.getElementById(url));
                  $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
                },
                error: function(newcounter, error) {
                  console.log('Failed to create');
                }
              });
            
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  

  
  

  
  

  


  
  

  

  

  

  

  

</body>
</html>
